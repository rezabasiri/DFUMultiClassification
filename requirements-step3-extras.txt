# ==============================================================================
# STEP 3: Additional ML/AI packages
# ==============================================================================
# Run: pip install -r requirements-step3-extras.txt
#
# WHY THIS IS LAST:
# -----------------
# These packages have flexible dependencies and should be installed after the
# core TensorFlow/PyTorch stack to avoid version conflicts.
#
# NUMPY COMPATIBILITY WARNING:
# ----------------------------
# Several packages in this file have NumPy version constraints:
# - shap>=0.50.0 requires numpy>=2.0 (INCOMPATIBLE with TensorFlow 2.15.1)
# - shap<0.50.0 works with numpy<2.0 (COMPATIBLE)
#
# We pin shap>=0.42.0,<0.50.0 to ensure NumPy 1.x compatibility.
# If you see "numpy.core._multiarray_umath failed to import", check:
#   pip show numpy  # Should be 1.26.x, NOT 2.x
#
# ==============================================================================

# ==========================================================================
# TRANSFORMERS / DIFFUSION STACK
# ==========================================================================
# For text/image generation, CLIP, stable diffusion, etc.
# These versions are tested to work together.
#
# IMPORTANT: Updated from transformers 4.35.0 to 4.57.6+ to support
# accelerate library (required for efficient Stable Diffusion loading).
# The accelerate library is strongly recommended by diffusers for:
# - Faster model loading
# - Lower memory usage during model initialization
# - Multi-GPU support for inference
transformers>=4.57.0
tokenizers>=0.22.0
diffusers==0.23.0
accelerate>=1.12.0

# ==========================================================================
# HYPERPARAMETER OPTIMIZATION
# ==========================================================================
# Bayesian optimization for model tuning
# scikit-optimize is lightweight alternative to Optuna
scikit-optimize>=0.9.0

# ==========================================================================
# MODEL INTERPRETABILITY
# ==========================================================================
# SHAP (SHapley Additive exPlanations) for feature importance
#
# CRITICAL VERSION CONSTRAINT:
# - shap>=0.50.0 requires numpy>=2.0 which breaks TensorFlow 2.15.1
# - We MUST use shap<0.50.0 to maintain numpy<2.0 compatibility
# - shap 0.49.x is the last version supporting numpy 1.x
#
# If pip resolves to shap>=0.50.0, manually install:
#   pip install "shap>=0.42.0,<0.50.0"
shap>=0.42.0,<0.50.0
