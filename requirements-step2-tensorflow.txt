# ==============================================================================
# STEP 2: TensorFlow with CUDA 12 and cuDNN fix
# ==============================================================================
# Run: pip install -r requirements-step2-tensorflow.txt
#
# WHY THIS ORDER MATTERS:
# -----------------------
# 1. PyTorch (step 1) installs nvidia-cudnn-cu12==9.x
# 2. TensorFlow 2.15.1 REQUIRES nvidia-cudnn-cu12==8.9.4.25
# 3. If cuDNN 9.x is present, TensorFlow fails with:
#      "DNN library initialization failed"
#      "Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR"
#
# This file installs TensorFlow first, then FORCE-REINSTALLS the correct cuDNN.
# The --force-reinstall ensures cuDNN 8.9.4.25 overwrites PyTorch's 9.x version.
#
# WHAT THIS INSTALLS:
# -------------------
# - tensorflow[and-cuda]==2.15.1: TensorFlow with CUDA 12.2 runtime
# - keras==2.15.0: Keras API (must match TensorFlow version)
# - nvidia-cudnn-cu12==8.9.4.25: cuDNN 8.9.4 for CUDA 12 (TensorFlow requirement)
#
# IMPORTANT: The [and-cuda] extra installs CUDA runtime libraries automatically.
# You do NOT need a system-wide CUDA installation.
#
# VERIFICATION:
# -------------
# python -c "import tensorflow as tf; print('TF:', tf.__version__); print('GPUs:', tf.config.list_physical_devices('GPU'))"
# Expected: GPUs: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
#
# If GPU list is empty, cuDNN version is likely wrong. Re-run:
#   pip install --force-reinstall nvidia-cudnn-cu12==8.9.4.25
#
# ==============================================================================

tensorflow[and-cuda]==2.15.1
keras==2.15.0

# CRITICAL: This MUST be installed AFTER tensorflow to override PyTorch's cuDNN 9.x
# Use pip install --force-reinstall for this specific package if issues persist
nvidia-cudnn-cu12==8.9.4.25
