[LOG] Output is being logged to: /workspace/DFUMultiClassification/results/logs/training.log
[LOG] Started at: 2026-02-13 17:55:24


================================================================================
SUBPROCESS ISOLATION: Running 2 folds in separate processes
  (Prevents TF/CUDA resource accumulation across folds)
================================================================================


================================================================================
FOLD 1/2 - Starting in isolated subprocess
Command: /venv/multimodal/bin/python src/main.py --mode search --cv_folds 2 --data_percentage 40.0 --verbosity 0 --fold 1 --resume_mode fresh
================================================================================


Fold 1/2 completed successfully.

================================================================================
FOLD 2/2 - Starting in isolated subprocess
Command: /venv/multimodal/bin/python src/main.py --mode search --cv_folds 2 --data_percentage 40.0 --verbosity 0 --fold 2 --resume_mode auto
================================================================================


Fold 2/2 completed successfully.

All 2 
âœ… Training completed successfully

======================================================================
COLLECTING PREDICTIONS FROM ALL FOLDS
======================================================================
Found 2 fold prediction files
  Loaded 600 predictions from pred_run1_metadata+depth_rgb_valid.npy
  Loaded 558 predictions from pred_run2_metadata+depth_rgb_valid.npy

âœ… Collected confidence scores for 547 unique samples
   (Aggregated from 2 fold files)

======================================================================
IDENTIFYING LOW-CONFIDENCE SAMPLES
======================================================================

Total samples: 547
Confidence metric: max_prob
Filtering mode: per_class
Per-class percentiles: I=17%, P=23%, R=15%

Per-class confidence thresholds:
  I: percentile=17%, threshold=0.3816, samples=180, flagged=30 (16.7%)
  P: percentile=23%, threshold=0.3951, samples=309, flagged=71 (23.0%)
  R: percentile=15%, threshold=0.3794, samples=58, flagged=8 (13.8%)

----------------------------------------------------------------------
LOW-CONFIDENCE SAMPLES IDENTIFIED
----------------------------------------------------------------------
Total flagged: 109 (19.9%)

Per-class breakdown:
  I: 30/180 flagged (16.7%)
  P: 71/309 flagged (23.0%)
  R: 8/58 flagged (13.8%)

======================================================================
SAVING RESULTS
======================================================================
âœ… Saved results to: /workspace/DFUMultiClassification/results/confidence_filter_results.json
âœ… Saved low-confidence samples to: /workspace/DFUMultiClassification/results/confidence_low_samples.csv
âœ… Saved all confidence scores to: /workspace/DFUMultiClassification/results/confidence_all_samples.csv

======================================================================
âœ… CONFIDENCE-BASED FILTERING COMPLETE
======================================================================
Finished: 2026-02-13 18:05:15

Summary:
  Total samples analyzed: 547
  Low-confidence samples: 109
  Results saved to: /workspace/DFUMultiClassification/results

ðŸ’¡ To retrain with filtered dataset, run with --retrain flag
âœ“ Identified 109 low-confidence samples to exclude
Set CONFIDENCE_EXCLUSION_FILE=/workspace/DFUMultiClassification/results/confidence_exclusion_list.txt
================================================================================


================================================================================
SUBPROCESS ISOLATION: Running 2 folds in separate processes
  (Prevents TF/CUDA resource accumulation across folds)
================================================================================


================================================================================
FOLD 1/2 - Starting in isolated subprocess
Command: /venv/multimodal/bin/python src/main.py --mode search --cv_folds 2 --data_percentage 40 --device-mode multi --verbosity 2 --fold 1 --resume_mode fresh
================================================================================


Fold 1/2 completed successfully.

================================================================================
FOLD 2/2 - Starting in isolated subprocess
Command: /venv/multimodal/bin/python src/main.py --mode search --cv_folds 2 --data_percentage 40 --device-mode multi --verbosity 2 --fold 2 --resume_mode auto
================================================================================


Fold 2/2 completed successfully.

All 2 folds completed successfully.
