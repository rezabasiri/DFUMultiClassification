[LOG] Output is being logged to: /workspace/DFUMultiClassification/results/logs/training_fold1.log
[LOG] Started at: 2026-02-13 17:10:54


================================================================================
DEVICE CONFIGURATION (mode: multi)
================================================================================

Detected 2 GPU(s):
  GPU 0: NVIDIA RTX A5000 - 24.0GB (compute 8.6)
  GPU 1: NVIDIA RTX A5000 - 24.0GB (compute 8.6)

Selected 2 GPU(s):
  GPU 0: NVIDIA RTX A5000 (24.0GB)
  GPU 1: NVIDIA RTX A5000 (24.0GB)
Enabled memory growth for 2 GPU(s)

Using MirroredStrategy (2 GPUs) with NCCL
  Compute capability 8.6 detected (native NCCL support)
  (Using NCCL for fastest multi-GPU communication)
  Effective batch size: 2Ã— global batch size
================================================================================


Batch size per replica: 300 (global batch size: 600, replicas: 2)

================================================================================
DFU MULTIMODAL CLASSIFICATION - PRODUCTION PIPELINE
================================================================================
Mode: search
Resume mode: fresh
Data percentage: 40.0%
Verbosity: 0 (MINIMAL)
Device: GPUs [0, 1] (multi-GPU mode, MirroredStrategy)
  Replicas: 2Ã— batch size distribution
Cross-validation: 2-fold CV (patient-level)

Configuration loaded from: src/utils/production_config.py
Image size: 256x256
Batch size: 600
  Per-GPU batch: 300 (600 / 2 GPUs)
Max epochs: 200 (with early stopping)
Modality search mode: custom
Will test 1 custom combinations
================================================================================


ðŸ§¹ FRESH START MODE: Deleting all checkpoints...
================================================================================

Cleanup Statistics:
================================================================================


Data Cleaning Configuration (from production_config.py):
  Outlier removal: False
  Misclassification tracking: none
Epoch 21: early stopping
Restoring model weights from the end of the best epoch: 1.
  WARNING: 0 trainable parameters! This will prevent learning!
/venv/multimodal/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py:86: UserWarning: The model does not have any trainable weights.
  warnings.warn("The model does not have any trainable weights.")
Epoch 11: early stopping
Restoring model weights from the end of the best epoch: 1.
Epoch 11: early stopping
Restoring model weights from the end of the best epoch: 1.

Run 1 Results for metadata+depth_rgb:
              precision    recall  f1-score   support

           I       0.30      0.62      0.41       189
           P       0.56      0.27      0.36       421
           R       0.31      0.42      0.36        74

    accuracy                           0.38       684
   macro avg       0.39      0.44      0.38       684
weighted avg       0.47      0.38      0.38       684

Cohen's Kappa: 0.2218

All results saved to /workspace/DFUMultiClassification/results/csv/modality_combination_results.csv

================================================================================
FINAL SUMMARY - BEST MODALITY COMBINATIONS
================================================================================

Best by Accuracy:
  Modalities: metadata+depth_rgb
  Accuracy: 0.3816 Â± 0.0000
  F1 Macro: 0.3762
  Kappa: 0.2218

Total combinations tested: 1
================================================================================

