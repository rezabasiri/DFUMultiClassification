
================================================================================
Base Model Comparison: SDXL 1.0 vs SD 3.5 Medium
================================================================================

Start time: 2026-01-19 10:11:14
Resolution: 128×128
Training: 3 epochs each
Evaluation: 50 samples, 4 quality metrics

================================================================================
Training SDXL 1.0
================================================================================

Command: python /workspace/DFUMultiClassification/agent_communication/generative_augmentation/scripts/train_lora_model.py --config /workspace/DFUMultiClassification/agent_communication/generative_augmentation/configs/test_sdxl.yaml
Started: 2026-01-19 10:11:14
2026-01-19 10:11:18.358825: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2026-01-19 10:11:18.358883: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2026-01-19 10:11:18.360128: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2026-01-19 10:11:18.366031: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2026-01-19 10:11:19.051683: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
================================================================================
Training Configuration: /workspace/DFUMultiClassification/agent_communication/generative_augmentation/configs/test_sdxl.yaml
Phase: I
Modality: rgb
Resolution: 128
================================================================================
Loading base model: stabilityai/stable-diffusion-xl-base-1.0
`torch_dtype` is deprecated! Use `dtype` instead!
Enabled xFormers memory-efficient attention
Enabled gradient checkpointing
LoRA Configuration:
  Rank: 16
  Alpha: 32
  Trainable parameters: 23,224,320 (0.90%)
/venv/multimodal/lib/python3.11/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/venv/multimodal/lib/python3.11/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Downloading: "https://download.pytorch.org/models/vgg16-397923af.pth" to /root/.cache/torch/hub/checkpoints/vgg16-397923af.pth
  0%|          | 0.00/528M [00:00<?, ?B/s]  1%|          | 3.50M/528M [00:00<00:15, 36.6MB/s]  3%|▎         | 17.8M/528M [00:00<00:05, 102MB/s]   6%|▌         | 32.0M/528M [00:00<00:04, 123MB/s]  9%|▉         | 46.2M/528M [00:00<00:03, 133MB/s] 11%|█▏        | 60.4M/528M [00:00<00:03, 138MB/s] 14%|█▍        | 74.6M/528M [00:00<00:03, 142MB/s] 17%|█▋        | 88.8M/528M [00:00<00:03, 144MB/s] 19%|█▉        | 103M/528M [00:00<00:03, 145MB/s]  22%|██▏       | 117M/528M [00:00<00:02, 145MB/s] 25%|██▍       | 131M/528M [00:01<00:02, 145MB/s] 27%|██▋       | 145M/528M [00:01<00:02, 147MB/s] 30%|███       | 159M/528M [00:01<00:02, 146MB/s] 33%|███▎      | 173M/528M [00:01<00:02, 147MB/s] 36%|███▌      | 188M/528M [00:01<00:02, 147MB/s] 38%|███▊      | 202M/528M [00:01<00:02, 147MB/s] 41%|████      | 216M/528M [00:01<00:02, 146MB/s] 44%|████▎     | 230M/528M [00:01<00:02, 145MB/s] 46%|████▌     | 244M/528M [00:01<00:02, 145MB/s] 49%|████▉     | 258M/528M [00:01<00:01, 146MB/s] 52%|█████▏    | 272M/528M [00:02<00:01, 146MB/s] 54%|█████▍    | 286M/528M [00:02<00:01, 146MB/s] 57%|█████▋    | 300M/528M [00:02<00:01, 147MB/s] 60%|█████▉    | 314M/528M [00:02<00:01, 147MB/s] 62%|██████▏   | 328M/528M [00:02<00:01, 147MB/s] 65%|██████▍   | 342M/528M [00:02<00:01, 147MB/s] 68%|██████▊   | 357M/528M [00:02<00:01, 147MB/s] 70%|███████   | 371M/528M [00:02<00:01, 147MB/s] 73%|███████▎  | 385M/528M [00:02<00:01, 147MB/s] 76%|███████▌  | 399M/528M [00:02<00:00, 148MB/s] 78%|███████▊  | 413M/528M [00:03<00:00, 147MB/s] 81%|████████  | 428M/528M [00:03<00:00, 148MB/s] 84%|████████▎ | 442M/528M [00:03<00:00, 148MB/s] 86%|████████▋ | 456M/528M [00:03<00:00, 147MB/s] 89%|████████▉ | 470M/528M [00:03<00:00, 147MB/s] 92%|█████████▏| 484M/528M [00:03<00:00, 147MB/s] 94%|█████████▍| 498M/528M [00:03<00:00, 147MB/s] 97%|█████████▋| 512M/528M [00:03<00:00, 147MB/s]100%|█████████▉| 526M/528M [00:03<00:00, 147MB/s]100%|██████████| 528M/528M [00:03<00:00, 144MB/s]
Enabled perceptual loss
Enabled EMA
Found 50 images for rgb/I
Dataset split: 42 train, 8 validation
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
/venv/multimodal/lib/python3.11/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Loading model from: /venv/multimodal/lib/python3.11/site-packages/lpips/weights/v0.1/alex.pth
/venv/multimodal/lib/python3.11/site-packages/torchmetrics/utilities/prints.py:43: UserWarning: Metric `InceptionScore` will save all extracted features in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)

Starting training...
Training on 1 GPUs
Total epochs: 3
Effective batch size: 2

Epoch 1/3
Epoch 0:   0%|          | 0/21 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/21 [00:01<?, ?it/s]
Traceback (most recent call last):
  File "/workspace/DFUMultiClassification/agent_communication/generative_augmentation/scripts/train_lora_model.py", line 758, in <module>
    main()
  File "/workspace/DFUMultiClassification/agent_communication/generative_augmentation/scripts/train_lora_model.py", line 647, in main
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/workspace/DFUMultiClassification/agent_communication/generative_augmentation/scripts/train_lora_model.py", line 258, in train_one_epoch
    latents = vae.encode(batch['pixel_values'].to(vae.dtype)).latent_dist.sample()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/venv/multimodal/lib/python3.11/site-packages/diffusers/utils/accelerate_utils.py", line 46, in wrapper
    return method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/venv/multimodal/lib/python3.11/site-packages/diffusers/models/autoencoders/autoencoder_kl.py", line 192, in encode
    h = self._encode(x)
        ^^^^^^^^^^^^^^^
  File "/venv/multimodal/lib/python3.11/site-packages/diffusers/models/autoencoders/autoencoder_kl.py", line 166, in _encode
    enc = self.encoder(x)
          ^^^^^^^^^^^^^^^
  File "/venv/multimodal/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/venv/multimodal/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/venv/multimodal/lib/python3.11/site-packages/diffusers/models/autoencoders/vae.py", line 156, in forward
    sample = self.conv_in(sample)
             ^^^^^^^^^^^^^^^^^^^^
  File "/venv/multimodal/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/venv/multimodal/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/venv/multimodal/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 548, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/venv/multimodal/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 543, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Input type (torch.cuda.HalfTensor) and weight type (torch.HalfTensor) should be the same

✗ SDXL 1.0 training failed with exit code 1
✗ SDXL training failed, skipping evaluation

================================================================================
Training SD 3.5 Medium
================================================================================

Command: python /workspace/DFUMultiClassification/agent_communication/generative_augmentation/scripts/train_lora_model.py --config /workspace/DFUMultiClassification/agent_communication/generative_augmentation/configs/test_sd3_medium.yaml
Started: 2026-01-19 10:11:56
2026-01-19 10:12:00.554570: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2026-01-19 10:12:00.554629: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2026-01-19 10:12:00.555936: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2026-01-19 10:12:00.562240: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2026-01-19 10:12:01.274909: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
================================================================================
Training Configuration: /workspace/DFUMultiClassification/agent_communication/generative_augmentation/configs/test_sd3_medium.yaml
Phase: I
Modality: rgb
Resolution: 128
================================================================================
Loading base model: stabilityai/stable-diffusion-3.5-medium
`torch_dtype` is deprecated! Use `dtype` instead!
Traceback (most recent call last):
  File "/venv/multimodal/lib/python3.11/site-packages/huggingface_hub/utils/_http.py", line 402, in hf_raise_for_status
    response.raise_for_status()
  File "/venv/multimodal/lib/python3.11/site-packages/requests/models.py", line 1026, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://huggingface.co/stabilityai/stable-diffusion-3.5-medium/resolve/main/unet/config.json

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/venv/multimodal/lib/python3.11/site-packages/diffusers/configuration_utils.py", line 392, in load_config
    config_file = hf_hub_download(
                  ^^^^^^^^^^^^^^^^
  File "/venv/multimodal/lib/python3.11/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/venv/multimodal/lib/python3.11/site-packages/huggingface_hub/file_download.py", line 1007, in hf_hub_download
    return _hf_hub_download_to_cache_dir(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/venv/multimodal/lib/python3.11/site-packages/huggingface_hub/file_download.py", line 1070, in _hf_hub_download_to_cache_dir
    (url_to_download, etag, commit_hash, expected_size, xet_file_data, head_call_error) = _get_metadata_or_catch_error(
                                                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/venv/multimodal/lib/python3.11/site-packages/huggingface_hub/file_download.py", line 1543, in _get_metadata_or_catch_error
    metadata = get_hf_file_metadata(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/venv/multimodal/lib/python3.11/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/venv/multimodal/lib/python3.11/site-packages/huggingface_hub/file_download.py", line 1460, in get_hf_file_metadata
    r = _request_wrapper(
        ^^^^^^^^^^^^^^^^^
  File "/venv/multimodal/lib/python3.11/site-packages/huggingface_hub/file_download.py", line 283, in _request_wrapper
    response = _request_wrapper(
               ^^^^^^^^^^^^^^^^^
  File "/venv/multimodal/lib/python3.11/site-packages/huggingface_hub/file_download.py", line 307, in _request_wrapper
    hf_raise_for_status(response)
  File "/venv/multimodal/lib/python3.11/site-packages/huggingface_hub/utils/_http.py", line 413, in hf_raise_for_status
    raise _format(EntryNotFoundError, message, response) from e
huggingface_hub.errors.EntryNotFoundError: 404 Client Error. (Request ID: Root=1-696e037b-725414a53794a97b32ea3717;dc6e4aaa-8915-4cc5-8568-ecb133b0ff2e)

Entry Not Found for url: https://huggingface.co/stabilityai/stable-diffusion-3.5-medium/resolve/main/unet/config.json.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/DFUMultiClassification/agent_communication/generative_augmentation/scripts/train_lora_model.py", line 758, in <module>
    main()
  File "/workspace/DFUMultiClassification/agent_communication/generative_augmentation/scripts/train_lora_model.py", line 524, in main
    vae, text_encoder, tokenizer, unet, noise_scheduler = load_base_models(config, accelerator)
                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/DFUMultiClassification/agent_communication/generative_augmentation/scripts/train_lora_model.py", line 124, in load_base_models
    unet = UNet2DConditionModel.from_pretrained(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/venv/multimodal/lib/python3.11/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/venv/multimodal/lib/python3.11/site-packages/diffusers/models/modeling_utils.py", line 1062, in from_pretrained
    config, unused_kwargs, commit_hash = cls.load_config(
                                         ^^^^^^^^^^^^^^^^
  File "/venv/multimodal/lib/python3.11/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/venv/multimodal/lib/python3.11/site-packages/diffusers/configuration_utils.py", line 419, in load_config
    raise EnvironmentError(
OSError: stabilityai/stable-diffusion-3.5-medium does not appear to have a file named config.json.

✗ SD 3.5 Medium training failed with exit code 1
✗ SD3.5 training failed, skipping evaluation

✗ Comparison incomplete due to training failures
