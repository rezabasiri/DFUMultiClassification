2026-01-19 14:19:11.050756: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2026-01-19 14:19:11.050823: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2026-01-19 14:19:11.051383: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2026-01-19 14:19:11.051445: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2026-01-19 14:19:11.052149: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2026-01-19 14:19:11.052623: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2026-01-19 14:19:11.058172: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2026-01-19 14:19:11.058235: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2026-01-19 14:19:11.753709: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2026-01-19 14:19:11.754426: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
================================================================================
Training Configuration: configs/test_sdxl.yaml
Phase: I
Modality: rgb
Resolution: 128
================================================================================
Loading base model: stabilityai/stable-diffusion-xl-base-1.0
Detected SDXL model - loading dual text encoders
`torch_dtype` is deprecated! Use `dtype` instead!
`torch_dtype` is deprecated! Use `dtype` instead!
Enabled gradient checkpointing
LoRA Configuration:
  Rank: 16
  Alpha: 32
  Trainable parameters: 23,224,320 (0.90%)
/venv/multimodal/lib/python3.11/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/venv/multimodal/lib/python3.11/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/venv/multimodal/lib/python3.11/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/venv/multimodal/lib/python3.11/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Enabled perceptual loss
Enabled EMA (on CPU to save GPU memory)
Found 50 images for rgb/I
Dataset split: 42 train, 8 validation
Found 50 images for rgb/I
Dataset split: 42 train, 8 validation
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
/venv/multimodal/lib/python3.11/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
/venv/multimodal/lib/python3.11/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Loading model from: /venv/multimodal/lib/python3.11/site-packages/lpips/weights/v0.1/alex.pth
Loading model from: /venv/multimodal/lib/python3.11/site-packages/lpips/weights/v0.1/alex.pth
/venv/multimodal/lib/python3.11/site-packages/torchmetrics/utilities/prints.py:43: UserWarning: Metric `InceptionScore` will save all extracted features in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)

Starting training...
Training on 2 GPUs
Total epochs: 20
Effective batch size: 4

Epoch 1/20
  Epoch 1 complete - Loss: 7.6415, LR: 1.00e-05
Train loss: 7.6415
  Validation: 2 batches - Loss: 0.5664
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Computing FID...
Computing quality metrics...
Computing FID...
/venv/multimodal/lib/python3.11/site-packages/torch/distributed/distributed_c10d.py:4876: UserWarning: barrier(): using the device under current context. You can specify `device_id` in `init_process_group` to mute this warning.
  warnings.warn(  # warn only once
Computing SSIM...
Computing SSIM...
Computing LPIPS...
Computing LPIPS...
Computing Inception Score...
Computing Inception Score...
Quality Metrics:
==================================================
FID: 454.65 (lower is better, < 50 is good)
SSIM: 0.1217 ± 0.0276 (higher is better, > 0.7 is good)
LPIPS: 0.6848 ± 0.0223 (lower is better, < 0.3 is good)
IS: 1.65 ± 0.09 (higher is better, > 2.0 is good)
==================================================
Val loss: 0.5664, Val FID: 454.65
  Removed old checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0000.pt
  Saved checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0000.pt

Epoch 2/20
  Epoch 2 complete - Loss: 8.9632, LR: 1.00e-05
Train loss: 8.9632
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
  Validation: 2 batches - Loss: 0.2909
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Computing FID...
Computing quality metrics...
Computing FID...
Computing SSIM...
Computing SSIM...
Computing LPIPS...
Computing LPIPS...
Computing Inception Score...
Computing Inception Score...
Quality Metrics:
==================================================
FID: 457.58 (lower is better, < 50 is good)
SSIM: 0.1192 ± 0.0274 (higher is better, > 0.7 is good)
LPIPS: 0.6817 ± 0.0236 (lower is better, < 0.3 is good)
IS: 1.86 ± 0.19 (higher is better, > 2.0 is good)
==================================================
Val loss: 0.2909, Val FID: 457.58
  Removed old checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0001.pt
  Saved checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0001.pt

Epoch 3/20
  Epoch 3 complete - Loss: 7.7200, LR: 1.00e-05
Train loss: 7.7200
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
  Validation: 2 batches - Loss: 0.3135
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Computing FID...
Computing quality metrics...
Computing FID...
Computing SSIM...
Computing SSIM...
Computing LPIPS...
Computing LPIPS...
Computing Inception Score...
Computing Inception Score...
Quality Metrics:
==================================================
FID: 447.79 (lower is better, < 50 is good)
SSIM: 0.1140 ± 0.0292 (higher is better, > 0.7 is good)
LPIPS: 0.6797 ± 0.0244 (lower is better, < 0.3 is good)
IS: 1.58 ± 0.12 (higher is better, > 2.0 is good)
==================================================
Val loss: 0.3135, Val FID: 447.79
  Saved checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0002.pt

Epoch 4/20
  Epoch 4 complete - Loss: 7.3357, LR: 1.00e-05
Train loss: 7.3357
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
  Validation: 2 batches - Loss: 0.4296
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Computing FID...
Computing quality metrics...
Computing FID...
Computing SSIM...
Computing SSIM...
Computing LPIPS...
Computing LPIPS...
Computing Inception Score...
Computing Inception Score...
Quality Metrics:
==================================================
FID: 447.71 (lower is better, < 50 is good)
SSIM: 0.1124 ± 0.0273 (higher is better, > 0.7 is good)
LPIPS: 0.6730 ± 0.0220 (lower is better, < 0.3 is good)
IS: 1.71 ± 0.17 (higher is better, > 2.0 is good)
==================================================
Val loss: 0.4296, Val FID: 447.71
  Saved checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0003.pt

Epoch 5/20
  Epoch 5 complete - Loss: 9.2869, LR: 1.00e-05
Train loss: 9.2869
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
  Validation: 2 batches - Loss: 0.2784
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Computing FID...
Computing quality metrics...
Computing FID...
Computing SSIM...
Computing SSIM...
Computing LPIPS...
Computing LPIPS...
Computing Inception Score...
Computing Inception Score...
Quality Metrics:
==================================================
FID: 456.08 (lower is better, < 50 is good)
SSIM: 0.1197 ± 0.0241 (higher is better, > 0.7 is good)
LPIPS: 0.6837 ± 0.0208 (lower is better, < 0.3 is good)
IS: 1.63 ± 0.19 (higher is better, > 2.0 is good)
==================================================
Val loss: 0.2784, Val FID: 456.08
  Removed old checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0002.pt
  Saved checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0004.pt

Epoch 6/20
  Epoch 6 complete - Loss: 7.1929, LR: 1.00e-05
Train loss: 7.1929
  Validation: 2 batches - Loss: 0.1865
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Computing FID...
Computing quality metrics...
Computing FID...
Computing SSIM...
Computing SSIM...
Computing LPIPS...
Computing LPIPS...
Computing Inception Score...
Computing Inception Score...
Quality Metrics:
==================================================
FID: 453.60 (lower is better, < 50 is good)
SSIM: 0.1137 ± 0.0242 (higher is better, > 0.7 is good)
LPIPS: 0.6802 ± 0.0267 (lower is better, < 0.3 is good)
IS: 1.69 ± 0.21 (higher is better, > 2.0 is good)
==================================================
Val loss: 0.1865, Val FID: 453.60
  Removed old checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0003.pt
  Saved checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0005.pt

Epoch 7/20
  Epoch 7 complete - Loss: 8.3650, LR: 1.00e-05
Train loss: 8.3650
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
  Validation: 2 batches - Loss: 0.2104
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Computing FID...
Computing quality metrics...
Computing FID...
Computing SSIM...
Computing SSIM...
Computing LPIPS...
Computing LPIPS...
Computing Inception Score...
Computing Inception Score...
Quality Metrics:
==================================================
FID: 449.80 (lower is better, < 50 is good)
SSIM: 0.1275 ± 0.0274 (higher is better, > 0.7 is good)
LPIPS: 0.6772 ± 0.0253 (lower is better, < 0.3 is good)
IS: 1.59 ± 0.08 (higher is better, > 2.0 is good)
==================================================
Val loss: 0.2104, Val FID: 449.80
  Removed old checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0004.pt
  Saved checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0006.pt

Epoch 8/20
  Epoch 8 complete - Loss: 6.4023, LR: 1.00e-05
Train loss: 6.4023
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
  Validation: 2 batches - Loss: 0.2257
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Computing FID...
Computing quality metrics...
Computing FID...
Computing SSIM...
Computing SSIM...
Computing LPIPS...
Computing LPIPS...
Computing Inception Score...
Computing Inception Score...
Quality Metrics:
==================================================
FID: 459.68 (lower is better, < 50 is good)
SSIM: 0.1161 ± 0.0298 (higher is better, > 0.7 is good)
LPIPS: 0.6803 ± 0.0252 (lower is better, < 0.3 is good)
IS: 1.64 ± 0.23 (higher is better, > 2.0 is good)
==================================================
Val loss: 0.2257, Val FID: 459.68
  Removed old checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0005.pt
  Saved checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0007.pt

Epoch 9/20
  Epoch 9 complete - Loss: 7.6691, LR: 1.00e-05
Train loss: 7.6691
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
  Validation: 2 batches - Loss: 0.1029
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Computing FID...
Computing quality metrics...
Computing FID...
Computing SSIM...
Computing SSIM...
Computing LPIPS...
Computing LPIPS...
Computing Inception Score...
Computing Inception Score...
Quality Metrics:
==================================================
FID: 458.53 (lower is better, < 50 is good)
SSIM: 0.1236 ± 0.0289 (higher is better, > 0.7 is good)
LPIPS: 0.6848 ± 0.0238 (lower is better, < 0.3 is good)
IS: 1.75 ± 0.11 (higher is better, > 2.0 is good)
==================================================
Val loss: 0.1029, Val FID: 458.53
  Removed old checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0006.pt
  Saved checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0008.pt

Epoch 10/20
  Epoch 10 complete - Loss: 5.9386, LR: 1.00e-05
Train loss: 5.9386
  Validation: 2 batches - Loss: 0.1553
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Computing FID...
Computing quality metrics...
Computing FID...
Computing SSIM...
Computing SSIM...
Computing LPIPS...
Computing LPIPS...
Computing Inception Score...
Computing Inception Score...
Quality Metrics:
==================================================
FID: 457.56 (lower is better, < 50 is good)
SSIM: 0.1237 ± 0.0300 (higher is better, > 0.7 is good)
LPIPS: 0.6871 ± 0.0232 (lower is better, < 0.3 is good)
IS: 1.62 ± 0.11 (higher is better, > 2.0 is good)
==================================================
Val loss: 0.1553, Val FID: 457.56
  Removed old checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0007.pt
  Saved checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0009.pt

Epoch 11/20
  Epoch 11 complete - Loss: 6.2144, LR: 1.00e-05
Train loss: 6.2144
  Validation: 2 batches - Loss: 0.1883
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Computing FID...
Computing quality metrics...
Computing FID...
Computing SSIM...
Computing SSIM...
Computing LPIPS...
Computing LPIPS...
Computing Inception Score...
Computing Inception Score...
Quality Metrics:
==================================================
FID: 451.79 (lower is better, < 50 is good)
SSIM: 0.1282 ± 0.0349 (higher is better, > 0.7 is good)
LPIPS: 0.6840 ± 0.0226 (lower is better, < 0.3 is good)
IS: 1.72 ± 0.18 (higher is better, > 2.0 is good)
==================================================
Val loss: 0.1883, Val FID: 451.79
  Removed old checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0008.pt
  Saved checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0010.pt

Epoch 12/20
  Epoch 12 complete - Loss: 6.7351, LR: 1.00e-05
Train loss: 6.7351
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
  Validation: 2 batches - Loss: 0.2257
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Computing FID...
Computing quality metrics...
Computing FID...
Computing SSIM...
Computing SSIM...
Computing LPIPS...
Computing LPIPS...
Computing Inception Score...
Computing Inception Score...
Quality Metrics:
==================================================
FID: 449.91 (lower is better, < 50 is good)
SSIM: 0.1255 ± 0.0290 (higher is better, > 0.7 is good)
LPIPS: 0.6869 ± 0.0205 (lower is better, < 0.3 is good)
IS: 1.69 ± 0.18 (higher is better, > 2.0 is good)
==================================================
Val loss: 0.2257, Val FID: 449.91
  Removed old checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0009.pt
  Saved checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0011.pt

Epoch 13/20
  Epoch 13 complete - Loss: 5.4747, LR: 1.00e-05
Train loss: 5.4747
  Validation: 2 batches - Loss: 0.2926
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Computing FID...
Computing quality metrics...
Computing FID...
Computing SSIM...
Computing SSIM...
Computing LPIPS...
Computing LPIPS...
Computing Inception Score...
Computing Inception Score...
Quality Metrics:
==================================================
FID: 453.36 (lower is better, < 50 is good)
SSIM: 0.1180 ± 0.0279 (higher is better, > 0.7 is good)
LPIPS: 0.6792 ± 0.0266 (lower is better, < 0.3 is good)
IS: 1.58 ± 0.11 (higher is better, > 2.0 is good)
==================================================
Val loss: 0.2926, Val FID: 453.36
  Removed old checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0010.pt
  Saved checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0012.pt

Epoch 14/20
  Epoch 14 complete - Loss: 6.5918, LR: 1.00e-05
Train loss: 6.5918
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
  Validation: 2 batches - Loss: 0.2436
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Computing FID...
Computing quality metrics...
Computing FID...
Computing SSIM...
Computing SSIM...
Computing LPIPS...
Computing LPIPS...
Computing Inception Score...
Computing Inception Score...
Quality Metrics:
==================================================
FID: 453.05 (lower is better, < 50 is good)
SSIM: 0.1194 ± 0.0311 (higher is better, > 0.7 is good)
LPIPS: 0.6867 ± 0.0238 (lower is better, < 0.3 is good)
IS: 1.63 ± 0.08 (higher is better, > 2.0 is good)
==================================================
Val loss: 0.2436, Val FID: 453.05
  Removed old checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0011.pt
  Saved checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0013.pt

Epoch 15/20
  Epoch 15 complete - Loss: 7.3175, LR: 1.00e-05
Train loss: 7.3175
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
  Validation: 2 batches - Loss: 0.0808
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Computing FID...
Computing quality metrics...
Computing FID...
Computing SSIM...
Computing SSIM...
Computing LPIPS...
Computing LPIPS...
Computing Inception Score...
Computing Inception Score...
Quality Metrics:
==================================================
FID: 448.88 (lower is better, < 50 is good)
SSIM: 0.1235 ± 0.0300 (higher is better, > 0.7 is good)
LPIPS: 0.6858 ± 0.0266 (lower is better, < 0.3 is good)
IS: 1.65 ± 0.18 (higher is better, > 2.0 is good)
==================================================
Val loss: 0.0808, Val FID: 448.88
  Removed old checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0012.pt
  Saved checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0014.pt

Epoch 16/20
  Epoch 16 complete - Loss: 6.7310, LR: 1.00e-05
Train loss: 6.7310
  Validation: 2 batches - Loss: 0.3125
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Computing FID...
Computing quality metrics...
Computing FID...
Computing SSIM...
Computing SSIM...
Computing LPIPS...
Computing LPIPS...
Computing Inception Score...
Computing Inception Score...
Quality Metrics:
==================================================
FID: 457.13 (lower is better, < 50 is good)
SSIM: 0.1266 ± 0.0338 (higher is better, > 0.7 is good)
LPIPS: 0.6875 ± 0.0223 (lower is better, < 0.3 is good)
IS: 1.74 ± 0.21 (higher is better, > 2.0 is good)
==================================================
Val loss: 0.3125, Val FID: 457.13
  Removed old checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0013.pt
  Saved checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0015.pt

Epoch 17/20
  Epoch 17 complete - Loss: 7.2825, LR: 1.00e-05
Train loss: 7.2825
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
  Validation: 2 batches - Loss: 0.1701
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Computing FID...
Computing quality metrics...
Computing FID...
Computing SSIM...
Computing SSIM...
Computing LPIPS...
Computing LPIPS...
Computing Inception Score...
Computing Inception Score...
Quality Metrics:
==================================================
FID: 447.83 (lower is better, < 50 is good)
SSIM: 0.1231 ± 0.0252 (higher is better, > 0.7 is good)
LPIPS: 0.6887 ± 0.0232 (lower is better, < 0.3 is good)
IS: 1.66 ± 0.14 (higher is better, > 2.0 is good)
==================================================
Val loss: 0.1701, Val FID: 447.83
  Removed old checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0014.pt
  Saved checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0016.pt

Epoch 18/20
  Epoch 18 complete - Loss: 5.6285, LR: 1.00e-05
Train loss: 5.6285
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
  Validation: 2 batches - Loss: 0.2118
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Computing FID...
Computing quality metrics...
Computing FID...
Computing SSIM...
Computing SSIM...
Computing LPIPS...
Computing LPIPS...
Computing Inception Score...
Computing Inception Score...
Quality Metrics:
==================================================
FID: 458.30 (lower is better, < 50 is good)
SSIM: 0.1123 ± 0.0255 (higher is better, > 0.7 is good)
LPIPS: 0.6829 ± 0.0215 (lower is better, < 0.3 is good)
IS: 1.60 ± 0.09 (higher is better, > 2.0 is good)
==================================================
Val loss: 0.2118, Val FID: 458.30
  Removed old checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0015.pt
  Saved checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0017.pt

Epoch 19/20
  Epoch 19 complete - Loss: 6.4590, LR: 1.00e-05
Train loss: 6.4590
  Validation: 2 batches - Loss: 0.1866
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Computing FID...
Computing quality metrics...
Computing FID...
Computing SSIM...
Computing SSIM...
Computing LPIPS...
Computing LPIPS...
Computing Inception Score...
Computing Inception Score...
Quality Metrics:
==================================================
FID: 451.64 (lower is better, < 50 is good)
SSIM: 0.1235 ± 0.0350 (higher is better, > 0.7 is good)
LPIPS: 0.6834 ± 0.0244 (lower is better, < 0.3 is good)
IS: 1.62 ± 0.08 (higher is better, > 2.0 is good)
==================================================
Val loss: 0.1866, Val FID: 451.64
  Removed old checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0016.pt
  Saved checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0018.pt

Epoch 20/20
  Epoch 20 complete - Loss: 5.2747, LR: 1.00e-05
Train loss: 5.2747
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
  Validation: 2 batches - Loss: 0.2385
Loaded 50 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
Computing FID...
Computing quality metrics...
Computing FID...
Computing SSIM...
Computing SSIM...
Computing LPIPS...
Computing LPIPS...
Computing Inception Score...
Computing Inception Score...
Quality Metrics:
==================================================
FID: 451.78 (lower is better, < 50 is good)
SSIM: 0.1221 ± 0.0323 (higher is better, > 0.7 is good)
LPIPS: 0.6771 ± 0.0247 (lower is better, < 0.3 is good)
IS: 1.64 ± 0.12 (higher is better, > 2.0 is good)
==================================================
Val loss: 0.2385, Val FID: 451.78
[rank1]:[W119 14:52:04.321740661 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
  Removed old checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0017.pt
  Saved checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0019.pt

Training complete!
  Removed old checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0018.pt
  Saved checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0019.pt
Saved metrics to: agent_communication/generative_augmentation/reports/test_sdxl_logs/metrics_history.json
[rank0]:[W119 14:52:20.433483083 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[rank0]:[W119 14:52:21.430979277 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
