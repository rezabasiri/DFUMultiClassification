2026-01-19 14:01:44.450470: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2026-01-19 14:01:44.450524: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2026-01-19 14:01:44.451856: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2026-01-19 14:01:44.458322: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2026-01-19 14:01:44.487740: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2026-01-19 14:01:44.487810: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2026-01-19 14:01:44.489019: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2026-01-19 14:01:44.495122: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2026-01-19 14:01:45.146521: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2026-01-19 14:01:45.199322: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
================================================================================
Training Configuration: configs/test_sdxl.yaml
Phase: I
Modality: rgb
Resolution: 32
================================================================================
Loading base model: stabilityai/stable-diffusion-xl-base-1.0
Detected SDXL model - loading dual text encoders
`torch_dtype` is deprecated! Use `dtype` instead!
`torch_dtype` is deprecated! Use `dtype` instead!
Enabled gradient checkpointing
/venv/multimodal/lib/python3.11/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/venv/multimodal/lib/python3.11/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
LoRA Configuration:
  Rank: 16
  Alpha: 32
  Trainable parameters: 23,224,320 (0.90%)
/venv/multimodal/lib/python3.11/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/venv/multimodal/lib/python3.11/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Enabled perceptual loss
Found 50 images for rgb/I
Dataset split: 42 train, 8 validation
Limited train set to 16 samples for fast testing
Enabled EMA (on CPU to save GPU memory)
Found 50 images for rgb/I
Dataset split: 42 train, 8 validation
Limited train set to 16 samples for fast testing
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
/venv/multimodal/lib/python3.11/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
/venv/multimodal/lib/python3.11/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Loading model from: /venv/multimodal/lib/python3.11/site-packages/lpips/weights/v0.1/alex.pth
/venv/multimodal/lib/python3.11/site-packages/torchmetrics/utilities/prints.py:43: UserWarning: Metric `InceptionScore` will save all extracted features in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
Loading model from: /venv/multimodal/lib/python3.11/site-packages/lpips/weights/v0.1/alex.pth

Starting training...
Training on 2 GPUs
Total epochs: 2
Effective batch size: 4

Epoch 1/2
  Epoch 1 complete - Loss: 17.9899, LR: 1.00e-05
Train loss: 17.9899
[SYNC DEBUG] Process 1 loading reference images...
  Validation: 2 batches - Loss: 0.3491
[SYNC DEBUG] Process 0 loading reference images...
Loaded 10 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
[SYNC DEBUG] Process 1 moving quality metrics to GPU...
[SYNC DEBUG] Process 1 offloading training models to CPU...
Loaded 10 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
[SYNC DEBUG] Process 0 moving quality metrics to GPU...
[SYNC DEBUG] Process 0 offloading training models to CPU...
[MEM DEBUG] Process 1 after offloading training models: allocated=0.60GB, reserved=0.64GB
[SYNC DEBUG] Process 1 finished offloading models
[SYNC DEBUG] Non-main process waiting for generated images...
[SYNC DEBUG] Process 1 broadcasting generated images...
[SYNC DEBUG] Process 1 received generated images: torch.Size([5, 3, 32, 32])
[SYNC DEBUG] Process 1 computing metrics...
Computing FID...
[FID DEBUG] Starting FID computation
[FID DEBUG] Real images shape: torch.Size([10, 3, 32, 32])
[FID DEBUG] Generated images shape: torch.Size([5, 3, 32, 32])
[FID DEBUG] Moved images to device: cuda:1
[FID DEBUG] After RGB conversion - Real: torch.Size([10, 3, 32, 32]), Gen: torch.Size([5, 3, 32, 32])
[FID DEBUG] Converted to uint8
[FID DEBUG] Updating FID metric with real images...
[MEM DEBUG] Process 0 after offloading training models: allocated=0.60GB, reserved=0.64GB
[SYNC DEBUG] Process 0 finished offloading models
Computing quality metrics...
  Generating samples for FID computation...
[SYNC DEBUG] Process 0 broadcasting generated images...
[SYNC DEBUG] Process 0 received generated images: torch.Size([5, 3, 32, 32])
[SYNC DEBUG] Process 0 computing metrics...
Computing FID...
[FID DEBUG] Starting FID computation
[FID DEBUG] Real images shape: torch.Size([10, 3, 32, 32])
[FID DEBUG] Generated images shape: torch.Size([5, 3, 32, 32])
[FID DEBUG] Moved images to device: cuda:0
[FID DEBUG] After RGB conversion - Real: torch.Size([10, 3, 32, 32]), Gen: torch.Size([5, 3, 32, 32])
[FID DEBUG] Converted to uint8
[FID DEBUG] Updating FID metric with real images...
[FID DEBUG] Real images updated successfully
[FID DEBUG] Updating FID metric with generated images...
[FID DEBUG] Real images updated successfully
[FID DEBUG] Updating FID metric with generated images...
[FID DEBUG] Generated images updated successfully
[FID DEBUG] Calling fid_metric.compute()...
/venv/multimodal/lib/python3.11/site-packages/torch/distributed/distributed_c10d.py:4876: UserWarning: barrier(): using the device under current context. You can specify `device_id` in `init_process_group` to mute this warning.
  warnings.warn(  # warn only once
[FID DEBUG] Generated images updated successfully
[FID DEBUG] Calling fid_metric.compute()...
[FID DEBUG] FID computed successfully: 410.1973876953125
[FID DEBUG] Resetting FID metric...
[FID DEBUG] FID metric reset successfully
Computing SSIM...
Computing LPIPS...
[FID DEBUG] FID computed successfully: 410.1973876953125
[FID DEBUG] Resetting FID metric...
[FID DEBUG] FID metric reset successfully
Computing SSIM...
Computing LPIPS...
Computing Inception Score...
Computing Inception Score...
[SYNC DEBUG] Process 0 finished computing metrics
[SYNC DEBUG] Process 0 cleaning up memory...
[SYNC DEBUG] Process 1 finished computing metrics
[SYNC DEBUG] Process 1 cleaning up memory...
[MEM DEBUG] Process 0 after metrics cleanup: allocated=0.28GB, reserved=0.34GB
[SYNC DEBUG] Process 0 calling wait_for_everyone()...
[MEM DEBUG] Process 1 after metrics cleanup: allocated=0.28GB, reserved=0.34GB
[SYNC DEBUG] Process 1 calling wait_for_everyone()...
[SYNC DEBUG] Process 0 passed wait_for_everyone()
[SYNC DEBUG] Process 1 passed wait_for_everyone()
Quality Metrics:
==================================================
FID: 410.20 (lower is better, < 50 is good)
SSIM: 0.0810 ± 0.0475 (higher is better, > 0.7 is good)
LPIPS: 0.3247 ± 0.0712 (lower is better, < 0.3 is good)
IS: 1.00 ± 0.00 (higher is better, > 2.0 is good)
==================================================
Val loss: 0.3491, Val FID: 410.20
[SYNC DEBUG] Process 0 restoring training models to GPU...
[SYNC DEBUG] Process 1 restoring training models to GPU...
[SYNC DEBUG] Process 0 restoring UNet...
[SYNC DEBUG] Process 1 restoring UNet...
[SYNC DEBUG] Process 1 restoring VAE...
[SYNC DEBUG] Process 0 restoring VAE...
[SYNC DEBUG] Process 0 restoring text_encoder...
[SYNC DEBUG] Process 1 restoring text_encoder...
[SYNC DEBUG] Process 0 restoring text_encoder_2...
[SYNC DEBUG] Process 1 restoring text_encoder_2...
[SYNC DEBUG] Process 0 finished restoring models
[SYNC DEBUG] Process 1 finished restoring models
  Removed old checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0000.pt
  Saved checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0000.pt

Epoch 2/2
  Epoch 2 complete - Loss: 15.4509, LR: 1.00e-05
Train loss: 15.4509
[SYNC DEBUG] Process 1 loading reference images...
Loaded 10 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
[SYNC DEBUG] Process 1 moving quality metrics to GPU...
[SYNC DEBUG] Process 1 offloading training models to CPU...
  Validation: 2 batches - Loss: 0.1742
[SYNC DEBUG] Process 0 loading reference images...
Loaded 10 reference images from /workspace/DFUMultiClassification/data/DFU_Updated/rgb/I
[SYNC DEBUG] Process 0 moving quality metrics to GPU...
[SYNC DEBUG] Process 0 offloading training models to CPU...
[MEM DEBUG] Process 1 after offloading training models: allocated=0.60GB, reserved=0.70GB
[SYNC DEBUG] Process 1 finished offloading models
[SYNC DEBUG] Non-main process waiting for generated images...
[SYNC DEBUG] Process 1 broadcasting generated images...
[SYNC DEBUG] Process 1 received generated images: torch.Size([5, 3, 32, 32])
[SYNC DEBUG] Process 1 computing metrics...
Computing FID...
[FID DEBUG] Starting FID computation
[FID DEBUG] Real images shape: torch.Size([10, 3, 32, 32])
[FID DEBUG] Generated images shape: torch.Size([5, 3, 32, 32])
[FID DEBUG] Moved images to device: cuda:1
[FID DEBUG] After RGB conversion - Real: torch.Size([10, 3, 32, 32]), Gen: torch.Size([5, 3, 32, 32])
[FID DEBUG] Converted to uint8
[FID DEBUG] Updating FID metric with real images...
[FID DEBUG] Real images updated successfully
[FID DEBUG] Updating FID metric with generated images...
[FID DEBUG] Generated images updated successfully
[FID DEBUG] Calling fid_metric.compute()...
[MEM DEBUG] Process 0 after offloading training models: allocated=0.60GB, reserved=0.70GB
[SYNC DEBUG] Process 0 finished offloading models
Computing quality metrics...
  Generating samples for FID computation...
[SYNC DEBUG] Process 0 broadcasting generated images...
[SYNC DEBUG] Process 0 received generated images: torch.Size([5, 3, 32, 32])
[SYNC DEBUG] Process 0 computing metrics...
Computing FID...
[FID DEBUG] Starting FID computation
[FID DEBUG] Real images shape: torch.Size([10, 3, 32, 32])
[FID DEBUG] Generated images shape: torch.Size([5, 3, 32, 32])
[FID DEBUG] Moved images to device: cuda:0
[FID DEBUG] After RGB conversion - Real: torch.Size([10, 3, 32, 32]), Gen: torch.Size([5, 3, 32, 32])
[FID DEBUG] Converted to uint8
[FID DEBUG] Updating FID metric with real images...
[FID DEBUG] Real images updated successfully
[FID DEBUG] Updating FID metric with generated images...
[FID DEBUG] Generated images updated successfully
[FID DEBUG] Calling fid_metric.compute()...
[FID DEBUG] FID computed successfully: 425.9554443359375
[FID DEBUG] Resetting FID metric...
[FID DEBUG] FID metric reset successfully
Computing SSIM...
[FID DEBUG] FID computed successfully: 425.9554443359375
[FID DEBUG] Resetting FID metric...
[FID DEBUG] FID metric reset successfully
Computing SSIM...
Computing LPIPS...
Computing LPIPS...
Computing Inception Score...
Computing Inception Score...
[SYNC DEBUG] Process 0 finished computing metrics
[SYNC DEBUG] Process 0 cleaning up memory...
[SYNC DEBUG] Process 1 finished computing metrics
[SYNC DEBUG] Process 1 cleaning up memory...
[MEM DEBUG] Process 0 after metrics cleanup: allocated=0.28GB, reserved=0.34GB
[SYNC DEBUG] Process 0 calling wait_for_everyone()...
[MEM DEBUG] Process 1 after metrics cleanup: allocated=0.28GB, reserved=0.34GB
[SYNC DEBUG] Process 1 calling wait_for_everyone()...
[SYNC DEBUG] Process 0 passed wait_for_everyone()
[SYNC DEBUG] Process 1 passed wait_for_everyone()
Quality Metrics:
==================================================
FID: 425.96 (lower is better, < 50 is good)
SSIM: 0.1213 ± 0.0426 (higher is better, > 0.7 is good)
LPIPS: 0.2837 ± 0.0762 (lower is better, < 0.3 is good)
IS: 1.00 ± 0.00 (higher is better, > 2.0 is good)
==================================================
Val loss: 0.1742, Val FID: 425.96
[SYNC DEBUG] Process 0 restoring training models to GPU...
[SYNC DEBUG] Process 1 restoring training models to GPU...
[SYNC DEBUG] Process 1 restoring UNet...
[SYNC DEBUG] Process 0 restoring UNet...
[SYNC DEBUG] Process 0 restoring VAE...
[SYNC DEBUG] Process 1 restoring VAE...
[SYNC DEBUG] Process 0 restoring text_encoder...
[SYNC DEBUG] Process 1 restoring text_encoder...
[SYNC DEBUG] Process 0 restoring text_encoder_2...
[SYNC DEBUG] Process 1 restoring text_encoder_2...
[SYNC DEBUG] Process 1 finished restoring models
[SYNC DEBUG] Process 0 finished restoring models
[rank1]:[W119 14:04:24.131083411 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
  Removed old checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0001.pt
  Saved checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0001.pt

Training complete!
  Removed old checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0001.pt
  Saved checkpoint: agent_communication/generative_augmentation/checkpoints/test_sdxl/checkpoint_epoch_0001.pt
Saved metrics to: agent_communication/generative_augmentation/reports/test_sdxl_logs/metrics_history.json
[rank0]:[W119 14:04:40.538437105 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[rank0]:[W119 14:04:41.540637432 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
