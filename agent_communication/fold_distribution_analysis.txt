2025-12-24 04:20:51.158653: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1766568051.184438 2710753 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1766568051.191945 2710753 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-12-24 04:20:51.224040: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
================================================================================
FOLD DISTRIBUTION ANALYSIS FOR THERMAL_MAP
================================================================================

Total data: 3107 samples
Class distribution (overall): {'I': 892, 'P': 1880, 'R': 335}

================================================================================
FOLD ANALYSIS (Validation sets)
================================================================================

Fold 1:
  Training samples: 154
  Validation samples: 79

  Validation class distribution:
    Class I: 17 (21.5%)
    Class P: 52 (65.8%)
    Class R: 10 (12.7%)

  Training class distribution:
    Class I: 38 (24.7%)
    Class P: 96 (62.3%)
    Class R: 20 (13.0%)

  Validation imbalance ratio: 5.20:1
  Minority class percentage: 12.7%
  -> Imbalanced (harder)

Fold 2:
  Training samples: 156
  Validation samples: 77

  Validation class distribution:
    Class I: 17 (22.1%)
    Class P: 48 (62.3%)
    Class R: 12 (15.6%)

  Training class distribution:
    Class I: 38 (24.4%)
    Class P: 100 (64.1%)
    Class R: 18 (11.5%)

  Validation imbalance ratio: 4.00:1
  Minority class percentage: 15.6%
  -> Imbalanced (harder)

Fold 3:
  Training samples: 156
  Validation samples: 77

  Validation class distribution:
    Class I: 21 (27.3%)
    Class P: 48 (62.3%)
    Class R: 8 (10.4%)

  Training class distribution:
    Class I: 34 (21.8%)
    Class P: 100 (64.1%)
    Class R: 22 (14.1%)

  Validation imbalance ratio: 6.00:1
  Minority class percentage: 10.4%
  -> Imbalanced (harder)

================================================================================
SUMMARY COMPARISON
================================================================================

Fold   Val Size   Imbalance    Minority %  
----------------------------------------
1      79         5.20         12.7        
2      77         4.00         15.6        
3      77         6.00         10.4        

================================================================================
HYPOTHESIS EVALUATION
================================================================================

Fold 3 imbalance ratio: 6.00
Avg imbalance of folds 1-2: 4.60

CONCLUSION: Fold 3 is MORE IMBALANCED
-> Higher accuracy despite harder fold suggests POSSIBLE LEAK
-> Needs further investigation
