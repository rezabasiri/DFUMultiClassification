2026-01-05 10:02:50.772687: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2026-01-05 10:02:50.772738: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2026-01-05 10:02:50.774292: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2026-01-05 10:02:51.646118: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
/venv/multimodal/lib/python3.11/site-packages/transformers/utils/generic.py:441: FutureWarning: `torch.utils._pytree._register_pytree_node` is deprecated. Please use `torch.utils._pytree.register_pytree_node` instead.
  _torch_pytree._register_pytree_node(
/venv/multimodal/lib/python3.11/site-packages/transformers/utils/generic.py:309: FutureWarning: `torch.utils._pytree._register_pytree_node` is deprecated. Please use `torch.utils._pytree.register_pytree_node` instead.
  _torch_pytree._register_pytree_node(
/venv/multimodal/lib/python3.11/site-packages/diffusers/utils/outputs.py:63: FutureWarning: `torch.utils._pytree._register_pytree_node` is deprecated. Please use `torch.utils._pytree.register_pytree_node` instead.
  torch.utils._pytree._register_pytree_node(

================================================================================
DEVICE CONFIGURATION (mode: multi)
================================================================================

Detected 8 GPU(s):
  GPU 0: NVIDIA GeForce RTX 4090 - 24.0GB (compute 8.9)
  GPU 1: NVIDIA GeForce RTX 4090 - 24.0GB (compute 8.9)
  GPU 2: NVIDIA GeForce RTX 4090 - 24.0GB (compute 8.9)
  GPU 3: NVIDIA GeForce RTX 4090 - 24.0GB (compute 8.9)
  GPU 4: NVIDIA GeForce RTX 4090 - 24.0GB (compute 8.9)
  GPU 5: NVIDIA GeForce RTX 4090 - 24.0GB (compute 8.9)
  GPU 6: NVIDIA GeForce RTX 4090 - 24.0GB (compute 8.9)
  GPU 7: NVIDIA GeForce RTX 4090 - 24.0GB (compute 8.9)

Selected 8 GPU(s):
  GPU 0: NVIDIA GeForce RTX 4090 (24.0GB)
  GPU 1: NVIDIA GeForce RTX 4090 (24.0GB)
  GPU 2: NVIDIA GeForce RTX 4090 (24.0GB)
  GPU 3: NVIDIA GeForce RTX 4090 (24.0GB)
  GPU 4: NVIDIA GeForce RTX 4090 (24.0GB)
  GPU 5: NVIDIA GeForce RTX 4090 (24.0GB)
  GPU 6: NVIDIA GeForce RTX 4090 (24.0GB)
  GPU 7: NVIDIA GeForce RTX 4090 (24.0GB)
Enabled memory growth for 8 GPU(s)

Using MirroredStrategy (8 GPUs) with NCCL
  Compute capability 8.9 detected (native NCCL support)
  (Using NCCL for fastest multi-GPU communication)
  Effective batch size: 8Ã— global batch size
================================================================================


Batch size per replica: 40 (global batch size: 320, replicas: 8)

================================================================================
DFU MULTIMODAL CLASSIFICATION - PRODUCTION PIPELINE
================================================================================
Mode: search
Resume mode: fresh
Data percentage: 50.0%
Verbosity: 2 (DETAILED)
Device: GPUs [0, 1, 2, 3, 4, 5, 6, 7] (multi-GPU mode, MirroredStrategy)
  Replicas: 8Ã— batch size distribution
Cross-validation: 3-fold CV (patient-level)

Configuration loaded from: src/utils/production_config.py
Image size: 128x128
Batch size: 320
  Per-GPU batch: 40 (320 / 8 GPUs)
Max epochs: 300 (with early stopping)
Modality search mode: custom
Will test 1 custom combinations
================================================================================


ðŸ§¹ FRESH START MODE: Deleting all checkpoints...
================================================================================

Cleanup Statistics:
  Models: 18 files deleted
  Predictions: 36 files deleted
  Csv Results: 15 files deleted
  Tf Cache: 4 files deleted
================================================================================


================================================================================
MODALITY SEARCH MODE: CUSTOM (1 combinations)
================================================================================
Testing only specified combinations from production_config.py
Total combinations to test: 1
Cross-validation mode: 3-fold CV
Iterations per combination: 3
Total training sessions: 3
Results will be saved to: /workspace/DFUMultiClassification/results/csv/modality_combination_results.csv
================================================================================


Testing modalities: metadata
Number of samples for each selected modality:
  metadata: 3107
Using 50.0% of the data: 1554 samples
Using strategy from main: MirroredStrategy

================================================================================
MULTI-GPU TRAINING: 8 GPUs
Global batch size: 320 (per-GPU: 40)
Strategy: MirroredStrategy
================================================================================


================================================================================
GENERATING 3-FOLD CROSS-VALIDATION SPLITS (PATIENT-LEVEL)
================================================================================
Fold 1/3: 150 train patients, 76 valid patients
  Train dist: {0: 0.291, 1: 0.605, 2: 0.104}
  Valid dist: {0: 0.286, 1: 0.600, 2: 0.114}
Fold 2/3: 151 train patients, 75 valid patients
  Train dist: {0: 0.286, 1: 0.599, 2: 0.115}
  Valid dist: {0: 0.297, 1: 0.614, 2: 0.089}
Fold 3/3: 151 train patients, 75 valid patients
  Train dist: {0: 0.292, 1: 0.607, 2: 0.101}
  Valid dist: {0: 0.285, 1: 0.598, 2: 0.117}
Generated 3 folds
All data will be validated exactly once across all folds
================================================================================


Fold 1/3
Using pre-computed fold 1 patient split
Processing metadata shape...

Unique cases: 489 (before oversampling)

True binary label distributions (unique cases):
Binary1: label_bin1
1    339
0    150
Name: count, dtype: int64
Binary2: label_bin2
0    427
1     62
Name: count, dtype: int64
Original class distribution (ordered):
Class 0: 364
Class 1: 736
Class 2: 148

Calculated alpha values from original distribution:
Alpha values (ordered) [I, P, R]: [0.759, 0.375, 1.866]
Using simple random oversampling...
Original class distribution (ordered):
Class 0: 364
Class 1: 736
Class 2: 148

After oversampling (ordered):
Class 0: 736
Class 1: 736
Class 2: 736

Alpha values after oversampling [I, P, R]: [1.0, 1.0, 1.0]
(Should be close to [1, 1, 1] since data is balanced)
Feature selection: 54 â†’ 40 features
Top 5 features: ['Peri-Ulcer Temperature Normalized (Â°C)', 'Wound Centre Temperature Normalized (Â°C)', 'Onset (Days)', 'BMI', 'Weight (Kg)']
Using Scikit-learn RandomForestClassifier
Using 40 features from training selection
Healing Phase Abs type: <class 'numpy.ndarray'> shape: (2208,)
Healing Phase Abs type: <class 'numpy.ndarray'> shape: (306,)
2026-01-05 10:03:09.259455: W tensorflow/core/kernels/data/cache_dataset_ops.cc:302] The calling iterator did not fully read the dataset being cached. In order to avoid unexpected truncation of the dataset, the partially cached contents of the dataset  will be discarded. This can happen if you have an input pipeline similar to `dataset.cache().take(k).repeat()`. You should use `dataset.take(k).cache().repeat()` instead.
Setting image shapes to 128x128...

Preparing datasets for Fold 1/3 with all modalities: ['metadata']
Using consistent patient split across all modality combinations for run 1

Class distributions:
Training: {0: 0.291, 1: 0.605, 2: 0.104}
Validation: {0: 0.286, 1: 0.6, 2: 0.114}

Unique cases: 410 (before oversampling)

True binary label distributions (unique cases):
Binary1: label_bin1
1    286
0    124
Name: count, dtype: int64
Binary2: label_bin2
0    365
1     45
Name: count, dtype: int64
Original class distribution (ordered):
Class 0: 314
Class 1: 653
Class 2: 112

Calculated alpha values from original distribution:
Alpha values (ordered) [I, P, R]: [0.7, 0.337, 1.963]
Using simple random oversampling...
Original class distribution (ordered):
Class 0: 314
Class 1: 653
Class 2: 112

After oversampling (ordered):
Class 0: 653
Class 1: 653
Class 2: 653

Alpha values after oversampling [I, P, R]: [1.0, 1.0, 1.0]
(Should be close to [1, 1, 1] since data is balanced)
Feature selection: 54 â†’ 40 features
Top 5 features: ['Peri-Ulcer Temperature Normalized (Â°C)', 'Wound Centre Temperature Normalized (Â°C)', 'Onset (Days)', 'BMI', 'Weight (Kg)']
Using Scikit-learn RandomForestClassifier
Using 40 features from training selection
Healing Phase Abs type: <class 'numpy.ndarray'> shape: (1959,)
Healing Phase Abs type: <class 'numpy.ndarray'> shape: (475,)

No existing data found for metadata, starting fresh

Training metadata with modalities: ['metadata'], fold 1/3
2026-01-05 10:03:17.048690: W tensorflow/core/kernels/data/cache_dataset_ops.cc:302] The calling iterator did not fully read the dataset being cached. In order to avoid unexpected truncation of the dataset, the partially cached contents of the dataset  will be discarded. This can happen if you have an input pipeline similar to `dataset.cache().take(k).repeat()`. You should use `dataset.take(k).cache().repeat()` instead.
Alpha values (ordered) [I, P, R]: [1.0, 1.0, 1.0]
Class weights: {0: 1, 1: 1, 2: 1} or [1, 1, 1]
Model: Metadata-only - using RF predictions directly (no Dense layer)
No existing pretrained weights found
Total model trainable weights: 0
Metadata-only: Minimal training on final layer
2026-01-05 10:03:28.523303: W tensorflow/core/kernels/data/cache_dataset_ops.cc:302] The calling iterator did not fully read the dataset being cached. In order to avoid unexpected truncation of the dataset, the partially cached contents of the dataset  will be discarded. This can happen if you have an input pipeline similar to `dataset.cache().take(k).repeat()`. You should use `dataset.take(k).cache().repeat()` instead.
Epoch 1/300 - loss: 0.1842 - val_loss: 0.4574 - acc: 0.9594 - val_acc: 0.5474 - macro_f1: 0.9596 - val_macro_f1: 0.4435 - kappa: 0.9391 - val_kappa: 0.1927
Epoch 20/300 - loss: 0.1770 - val_loss: 0.4574 - acc: 0.9652 - val_acc: 0.5474 - macro_f1: 0.9641 - val_macro_f1: 0.4435 - kappa: 0.9477 - val_kappa: 0.1927
Restoring model weights from the end of the best epoch: 1.
Epoch 21: early stopping

Run 1 Results for metadata:
Cohen's Kappa: 0.2867

Confusion Matrix (validation):
        Predicted: I    P    R
Actual Inflam:   80   51    5
Actual Prolif:   82  171   32
Actual Remodl:   10   35    9

Training gating network for run 1...

Number of models: 1

Initializing gating network training...
Number of models: 1
Shape of first model predictions: (1959, 3)
Shape of true labels: (1959,)
Skipping gating network: only 1 model(s), need at least 2 to combine

Gating Network Results for Run 1:
Accuracy: 0.5474
F1 Macro: 0.4435
Kappa: 0.2867
Removed cache file: /workspace/DFUMultiClassification/results/tf_records/tf_cache_train_metadata_fold0_seed42.data-00000-of-00001
Removed cache file: /workspace/DFUMultiClassification/results/tf_records/tf_cache_train_metadata_fold0_seed42.index
Removed cache file: /workspace/DFUMultiClassification/results/tf_records/tf_cache_valid_metadata_fold0_seed42.data-00000-of-00001
Removed cache file: /workspace/DFUMultiClassification/results/tf_records/tf_cache_valid_metadata_fold0_seed42.index

Fold 2/3
Using pre-computed fold 2 patient split
Processing metadata shape...

Unique cases: 489 (before oversampling)

True binary label distributions (unique cases):
Binary1: label_bin1
1    339
0    150
Name: count, dtype: int64
Binary2: label_bin2
0    427
1     62
Name: count, dtype: int64
Original class distribution (ordered):
Class 0: 364
Class 1: 736
Class 2: 148

Calculated alpha values from original distribution:
Alpha values (ordered) [I, P, R]: [0.759, 0.375, 1.866]
Using simple random oversampling...
Original class distribution (ordered):
Class 0: 364
Class 1: 736
Class 2: 148

After oversampling (ordered):
Class 0: 736
Class 1: 736
Class 2: 736

Alpha values after oversampling [I, P, R]: [1.0, 1.0, 1.0]
(Should be close to [1, 1, 1] since data is balanced)
Feature selection: 54 â†’ 40 features
Top 5 features: ['Peri-Ulcer Temperature Normalized (Â°C)', 'Wound Centre Temperature Normalized (Â°C)', 'Onset (Days)', 'BMI', 'Weight (Kg)']
Using Scikit-learn RandomForestClassifier
Using 40 features from training selection
Healing Phase Abs type: <class 'numpy.ndarray'> shape: (2208,)
Healing Phase Abs type: <class 'numpy.ndarray'> shape: (306,)
2026-01-05 10:04:12.307868: W tensorflow/core/kernels/data/cache_dataset_ops.cc:302] The calling iterator did not fully read the dataset being cached. In order to avoid unexpected truncation of the dataset, the partially cached contents of the dataset  will be discarded. This can happen if you have an input pipeline similar to `dataset.cache().take(k).repeat()`. You should use `dataset.take(k).cache().repeat()` instead.
Setting image shapes to 128x128...

Preparing datasets for Fold 2/3 with all modalities: ['metadata']
Using consistent patient split across all modality combinations for run 2

Class distributions:
Training: {0: 0.286, 1: 0.599, 2: 0.115}
Validation: {0: 0.297, 1: 0.614, 2: 0.089}

Unique cases: 389 (before oversampling)

True binary label distributions (unique cases):
Binary1: label_bin1
1    266
0    123
Name: count, dtype: int64
Binary2: label_bin2
0    337
1     52
Name: count, dtype: int64
Original class distribution (ordered):
Class 0: 297
Class 1: 622
Class 2: 120

Calculated alpha values from original distribution:
Alpha values (ordered) [I, P, R]: [0.759, 0.362, 1.879]
Using simple random oversampling...
Original class distribution (ordered):
Class 0: 297
Class 1: 622
Class 2: 120

After oversampling (ordered):
Class 0: 622
Class 1: 622
Class 2: 622

Alpha values after oversampling [I, P, R]: [1.0, 1.0, 1.0]
(Should be close to [1, 1, 1] since data is balanced)
Feature selection: 54 â†’ 40 features
Top 5 features: ['Peri-Ulcer Temperature Normalized (Â°C)', 'Wound Centre Temperature Normalized (Â°C)', 'Onset (Days)', 'BMI', 'Intact Skin Temperature (Â°C)']
Using Scikit-learn RandomForestClassifier
Using 40 features from training selection
Healing Phase Abs type: <class 'numpy.ndarray'> shape: (1866,)
Healing Phase Abs type: <class 'numpy.ndarray'> shape: (515,)

No existing data found for metadata, starting fresh

Training metadata with modalities: ['metadata'], fold 2/3
2026-01-05 10:04:18.913090: W tensorflow/core/kernels/data/cache_dataset_ops.cc:302] The calling iterator did not fully read the dataset being cached. In order to avoid unexpected truncation of the dataset, the partially cached contents of the dataset  will be discarded. This can happen if you have an input pipeline similar to `dataset.cache().take(k).repeat()`. You should use `dataset.take(k).cache().repeat()` instead.
Alpha values (ordered) [I, P, R]: [1.0, 1.0, 1.0]
Class weights: {0: 1, 1: 1, 2: 1} or [1, 1, 1]
Model: Metadata-only - using RF predictions directly (no Dense layer)
No existing pretrained weights found
Total model trainable weights: 0
Metadata-only: Minimal training on final layer
2026-01-05 10:04:27.862814: W tensorflow/core/kernels/data/cache_dataset_ops.cc:302] The calling iterator did not fully read the dataset being cached. In order to avoid unexpected truncation of the dataset, the partially cached contents of the dataset  will be discarded. This can happen if you have an input pipeline similar to `dataset.cache().take(k).repeat()`. You should use `dataset.take(k).cache().repeat()` instead.
Epoch 1/300 - loss: 0.1773 - val_loss: 0.4700 - acc: 0.9667 - val_acc: 0.4854 - macro_f1: 0.9666 - val_macro_f1: 0.4130 - kappa: 0.9500 - val_kappa: 0.1220
Epoch 20/300 - loss: 0.1752 - val_loss: 0.4700 - acc: 0.9708 - val_acc: 0.4854 - macro_f1: 0.9705 - val_macro_f1: 0.4130 - kappa: 0.9563 - val_kappa: 0.1220
Restoring model weights from the end of the best epoch: 1.
Epoch 21: early stopping

Run 2 Results for metadata:
Cohen's Kappa: 0.1818

Confusion Matrix (validation):
        Predicted: I    P    R
Actual Inflam:   77   61   15
Actual Prolif:  110  159   47
Actual Remodl:   12   20   14

Training gating network for run 2...

Number of models: 1

Initializing gating network training...
Number of models: 1
Shape of first model predictions: (1866, 3)
Shape of true labels: (1866,)
Skipping gating network: only 1 model(s), need at least 2 to combine

Gating Network Results for Run 2:
Accuracy: 0.4854
F1 Macro: 0.4130
Kappa: 0.1818
Removed cache file: /workspace/DFUMultiClassification/results/tf_records/tf_cache_train_metadata_fold1_seed42.data-00000-of-00001
Removed cache file: /workspace/DFUMultiClassification/results/tf_records/tf_cache_train_metadata_fold1_seed42.index
Removed cache file: /workspace/DFUMultiClassification/results/tf_records/tf_cache_valid_metadata_fold1_seed42.data-00000-of-00001
Removed cache file: /workspace/DFUMultiClassification/results/tf_records/tf_cache_valid_metadata_fold1_seed42.index

Fold 3/3
Using pre-computed fold 3 patient split
Processing metadata shape...

Unique cases: 489 (before oversampling)

True binary label distributions (unique cases):
Binary1: label_bin1
1    339
0    150
Name: count, dtype: int64
Binary2: label_bin2
0    427
1     62
Name: count, dtype: int64
Original class distribution (ordered):
Class 0: 364
Class 1: 736
Class 2: 148

Calculated alpha values from original distribution:
Alpha values (ordered) [I, P, R]: [0.759, 0.375, 1.866]
Using simple random oversampling...
Original class distribution (ordered):
Class 0: 364
Class 1: 736
Class 2: 148

After oversampling (ordered):
Class 0: 736
Class 1: 736
Class 2: 736

Alpha values after oversampling [I, P, R]: [1.0, 1.0, 1.0]
(Should be close to [1, 1, 1] since data is balanced)
Feature selection: 54 â†’ 40 features
Top 5 features: ['Peri-Ulcer Temperature Normalized (Â°C)', 'Wound Centre Temperature Normalized (Â°C)', 'Onset (Days)', 'BMI', 'Weight (Kg)']
Using Scikit-learn RandomForestClassifier
Using 40 features from training selection
Healing Phase Abs type: <class 'numpy.ndarray'> shape: (2208,)
Healing Phase Abs type: <class 'numpy.ndarray'> shape: (306,)
2026-01-05 10:05:11.344900: W tensorflow/core/kernels/data/cache_dataset_ops.cc:302] The calling iterator did not fully read the dataset being cached. In order to avoid unexpected truncation of the dataset, the partially cached contents of the dataset  will be discarded. This can happen if you have an input pipeline similar to `dataset.cache().take(k).repeat()`. You should use `dataset.take(k).cache().repeat()` instead.
Setting image shapes to 128x128...

Preparing datasets for Fold 3/3 with all modalities: ['metadata']
Using consistent patient split across all modality combinations for run 3

Class distributions:
Training: {0: 0.292, 1: 0.607, 2: 0.101}
Validation: {0: 0.285, 1: 0.598, 2: 0.117}

Unique cases: 397 (before oversampling)

True binary label distributions (unique cases):
Binary1: label_bin1
1    270
0    127
Name: count, dtype: int64
Binary2: label_bin2
0    352
1     45
Name: count, dtype: int64
Original class distribution (ordered):
Class 0: 289
Class 1: 601
Class 2: 100

Calculated alpha values from original distribution:
Alpha values (ordered) [I, P, R]: [0.686, 0.33, 1.984]
Using simple random oversampling...
Original class distribution (ordered):
Class 0: 289
Class 1: 601
Class 2: 100

After oversampling (ordered):
Class 0: 601
Class 1: 601
Class 2: 601

Alpha values after oversampling [I, P, R]: [1.0, 1.0, 1.0]
(Should be close to [1, 1, 1] since data is balanced)
Feature selection: 54 â†’ 40 features
Top 5 features: ['Peri-Ulcer Temperature Normalized (Â°C)', 'Wound Centre Temperature Normalized (Â°C)', 'Onset (Days)', 'BMI', 'Weight (Kg)']
Using Scikit-learn RandomForestClassifier
Using 40 features from training selection
Healing Phase Abs type: <class 'numpy.ndarray'> shape: (1803,)
Healing Phase Abs type: <class 'numpy.ndarray'> shape: (564,)

No existing data found for metadata, starting fresh

Training metadata with modalities: ['metadata'], fold 3/3
2026-01-05 10:05:18.053797: W tensorflow/core/kernels/data/cache_dataset_ops.cc:302] The calling iterator did not fully read the dataset being cached. In order to avoid unexpected truncation of the dataset, the partially cached contents of the dataset  will be discarded. This can happen if you have an input pipeline similar to `dataset.cache().take(k).repeat()`. You should use `dataset.take(k).cache().repeat()` instead.
Alpha values (ordered) [I, P, R]: [1.0, 1.0, 1.0]
Class weights: {0: 1, 1: 1, 2: 1} or [1, 1, 1]
Model: Metadata-only - using RF predictions directly (no Dense layer)
No existing pretrained weights found
Total model trainable weights: 0
Metadata-only: Minimal training on final layer
2026-01-05 10:05:27.210668: W tensorflow/core/kernels/data/cache_dataset_ops.cc:302] The calling iterator did not fully read the dataset being cached. In order to avoid unexpected truncation of the dataset, the partially cached contents of the dataset  will be discarded. This can happen if you have an input pipeline similar to `dataset.cache().take(k).repeat()`. You should use `dataset.take(k).cache().repeat()` instead.
Epoch 1/300 - loss: 0.1760 - val_loss: 0.4435 - acc: 0.9734 - val_acc: 0.5656 - macro_f1: 0.9736 - val_macro_f1: 0.4179 - kappa: 0.9602 - val_kappa: 0.1207
Epoch 20/300 - loss: 0.1739 - val_loss: 0.4435 - acc: 0.9771 - val_acc: 0.5656 - macro_f1: 0.9769 - val_macro_f1: 0.4179 - kappa: 0.9656 - val_kappa: 0.1207
Restoring model weights from the end of the best epoch: 1.
Epoch 21: early stopping

Run 3 Results for metadata:
Cohen's Kappa: 0.1918

Confusion Matrix (validation):
        Predicted: I    P    R
Actual Inflam:   53  105    3
Actual Prolif:   69  257   11
Actual Remodl:    8   49    9

Training gating network for run 3...

Number of models: 1

Initializing gating network training...
Number of models: 1
Shape of first model predictions: (1803, 3)
Shape of true labels: (1803,)
Skipping gating network: only 1 model(s), need at least 2 to combine

Gating Network Results for Run 3:
Accuracy: 0.5656
F1 Macro: 0.4179
Kappa: 0.1918
Results saved to /workspace/DFUMultiClassification/results/csv/modality_results_averaged.csv
Saved metadata predictions to /workspace/DFUMultiClassification/results/checkpoints/combo_pred_metadata_run1_train.npy
Saved metadata predictions to /workspace/DFUMultiClassification/results/checkpoints/combo_pred_metadata_run1_valid.npy
Saved metadata predictions to /workspace/DFUMultiClassification/results/checkpoints/combo_pred_metadata_run2_train.npy
Saved metadata predictions to /workspace/DFUMultiClassification/results/checkpoints/combo_pred_metadata_run2_valid.npy
Saved metadata predictions to /workspace/DFUMultiClassification/results/checkpoints/combo_pred_metadata_run3_train.npy
Saved metadata predictions to /workspace/DFUMultiClassification/results/checkpoints/combo_pred_metadata_run3_valid.npy
Results for metadata appended to /workspace/DFUMultiClassification/results/csv/modality_combination_results.csv

All results saved to /workspace/DFUMultiClassification/results/csv/modality_combination_results.csv

================================================================================
FINAL SUMMARY - BEST MODALITY COMBINATIONS
================================================================================

Best by Accuracy:
  Modalities: metadata
  Accuracy: 0.5328 Â± 0.0343
  F1 Macro: 0.4248
  Kappa: 0.2201

Total combinations tested: 1
================================================================================

