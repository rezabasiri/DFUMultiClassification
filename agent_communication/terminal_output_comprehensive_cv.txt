================================================================================
COMPREHENSIVE CV TEST: All Modalities with Leak Detection
================================================================================

Start time: 2025-12-23 11:19:43

Configuration:
  Image size: 32x32
  Batch size: 16
  Max epochs: 10
  CV folds: 3
  Data: 100%

Modalities to test: 5
  - metadata
  - depth_rgb
  - depth_map
  - thermal_map
  - metadata+depth_rgb

ðŸ§¹ FRESH START MODE: Deleting all checkpoints...
================================================================================

Cleanup Statistics:
  Models: 12 files deleted
  Predictions: 60 files deleted
  Csv Results: 14 files deleted
  Tf Cache: 18 files deleted
================================================================================


[1/5] Testing: metadata

================================================================================
Testing: metadata
================================================================================
Loading data for metadata...
Data loaded: 3107 samples
Running 3-fold CV...
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'metadata_input': 'metadata_input'}
Received: inputs={'sample_id': 'Tensor(shape=(32, 3))', 'metadata_input': 'Tensor(shape=(32, 3))'}
  warnings.warn(msg)
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'metadata_input': 'metadata_input'}
Received: inputs={'sample_id': 'Tensor(shape=(None, 3))', 'metadata_input': 'Tensor(shape=(None, 3))'}
  warnings.warn(msg)
Epoch 1/2 - loss: 1.2613 - val_loss: 0.6458 - acc: 0.2773 - val_acc: 0.2530 - macro_f1: 0.1981 - val_macro_f1: 0.2052 - kappa: -0.0833 - val_kappa: -0.0114
Epoch 2/2 - loss: 1.2049 - val_loss: 0.6415 - acc: 0.2759 - val_acc: 0.2622 - macro_f1: 0.1971 - val_macro_f1: 0.2176 - kappa: -0.0855 - val_kappa: -0.0085
Restoring model weights from the end of the best epoch: 2.

Run 1 Results for metadata:
              precision    recall  f1-score   support

           I       0.16      0.03      0.06       293
           P       0.57      0.24      0.33       716
           R       0.16      0.75      0.26       177

    accuracy                           0.26      1186
   macro avg       0.30      0.34      0.22      1186
weighted avg       0.41      0.26      0.25      1186

Cohen's Kappa: 0.0238
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'metadata_input': 'metadata_input'}
Received: inputs={'sample_id': 'Tensor(shape=(32, 3))', 'metadata_input': 'Tensor(shape=(32, 3))'}
  warnings.warn(msg)
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'metadata_input': 'metadata_input'}
Received: inputs={'sample_id': 'Tensor(shape=(None, 3))', 'metadata_input': 'Tensor(shape=(None, 3))'}
  warnings.warn(msg)
Epoch 1/2 - loss: 1.3804 - val_loss: 0.7905 - acc: 0.3038 - val_acc: 0.2651 - macro_f1: 0.2199 - val_macro_f1: 0.2217 - kappa: -0.0311 - val_kappa: 0.0190
Epoch 2/2 - loss: 1.3160 - val_loss: 0.7497 - acc: 0.3046 - val_acc: 0.2772 - macro_f1: 0.2185 - val_macro_f1: 0.2289 - kappa: -0.0360 - val_kappa: 0.0257
Restoring model weights from the end of the best epoch: 2.

Run 2 Results for metadata:
              precision    recall  f1-score   support

           I       0.26      0.94      0.41       249
           P       0.44      0.03      0.05       591
           R       0.37      0.16      0.22       152

    accuracy                           0.28       992
   macro avg       0.36      0.38      0.23       992
weighted avg       0.38      0.28      0.17       992

Cohen's Kappa: 0.0948
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'metadata_input': 'metadata_input'}
Received: inputs={'sample_id': 'Tensor(shape=(32, 3))', 'metadata_input': 'Tensor(shape=(32, 3))'}
  warnings.warn(msg)
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'metadata_input': 'metadata_input'}
Received: inputs={'sample_id': 'Tensor(shape=(None, 3))', 'metadata_input': 'Tensor(shape=(None, 3))'}
  warnings.warn(msg)
Epoch 1/2 - loss: 0.6647 - val_loss: 0.6380 - acc: 0.3635 - val_acc: 0.2542 - macro_f1: 0.3591 - val_macro_f1: 0.1796 - kappa: 0.0484 - val_kappa: 0.0146
Epoch 2/2 - loss: 0.6216 - val_loss: 0.6127 - acc: 0.3788 - val_acc: 0.2542 - macro_f1: 0.3695 - val_macro_f1: 0.1796 - kappa: 0.0726 - val_kappa: 0.0146
Restoring model weights from the end of the best epoch: 1.

Run 3 Results for metadata:
              precision    recall  f1-score   support

           I       0.25      0.99      0.39       235
           P       0.00      0.00      0.00       577
           R       0.67      0.08      0.14       148

    accuracy                           0.25       960
   macro avg       0.30      0.36      0.18       960
weighted avg       0.16      0.25      0.12       960

Cohen's Kappa: 0.0362
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized

[2/5] Testing: depth_rgb

================================================================================
Testing: depth_rgb
================================================================================
Loading data for depth_rgb...
Data loaded: 3107 samples
Running 3-fold CV...
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'depth_rgb_input': 'depth_rgb_input'}
Received: inputs={'sample_id': 'Tensor(shape=(32, 3))', 'depth_rgb_input': 'Tensor(shape=(32, 12, 12, 3))'}
  warnings.warn(msg)
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'depth_rgb_input': 'depth_rgb_input'}
Received: inputs={'sample_id': 'Tensor(shape=(None, 3))', 'depth_rgb_input': 'Tensor(shape=(None, 12, 12, 3))'}
  warnings.warn(msg)
Epoch 1/2 - loss: 2.0119 - val_loss: 1.9001 - acc: 0.3616 - val_acc: 0.5953 - macro_f1: 0.3557 - val_macro_f1: 0.2868 - kappa: 0.0419 - val_kappa: 0.0191
Epoch 2/2 - loss: 1.8744 - val_loss: 1.8088 - acc: 0.3835 - val_acc: 0.2858 - macro_f1: 0.3797 - val_macro_f1: 0.2806 - kappa: 0.0750 - val_kappa: -0.0279
Restoring model weights from the end of the best epoch: 1.

Run 1 Results for depth_rgb:
              precision    recall  f1-score   support

           I       0.32      0.05      0.08       293
           P       0.61      0.96      0.74       716
           R       0.38      0.02      0.03       177

    accuracy                           0.60      1186
   macro avg       0.43      0.34      0.29      1186
weighted avg       0.50      0.60      0.48      1186

Cohen's Kappa: 0.0213
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'depth_rgb_input': 'depth_rgb_input'}
Received: inputs={'sample_id': 'Tensor(shape=(32, 3))', 'depth_rgb_input': 'Tensor(shape=(32, 12, 12, 3))'}
  warnings.warn(msg)
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'depth_rgb_input': 'depth_rgb_input'}
Received: inputs={'sample_id': 'Tensor(shape=(None, 3))', 'depth_rgb_input': 'Tensor(shape=(None, 12, 12, 3))'}
  warnings.warn(msg)
Epoch 1/2 - loss: 1.9922 - val_loss: 1.9409 - acc: 0.3630 - val_acc: 0.1633 - macro_f1: 0.3583 - val_macro_f1: 0.1226 - kappa: 0.0404 - val_kappa: 0.0002
Epoch 2/2 - loss: 1.8527 - val_loss: 1.7808 - acc: 0.3730 - val_acc: 0.3488 - macro_f1: 0.3683 - val_macro_f1: 0.3384 - kappa: 0.0621 - val_kappa: 0.0302
Restoring model weights from the end of the best epoch: 2.

Run 2 Results for depth_rgb:
              precision    recall  f1-score   support

           I       0.23      0.35      0.28       249
           P       0.59      0.31      0.41       591
           R       0.25      0.50      0.33       152

    accuracy                           0.35       992
   macro avg       0.36      0.39      0.34       992
weighted avg       0.45      0.35      0.36       992

Cohen's Kappa: 0.0792
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'depth_rgb_input': 'depth_rgb_input'}
Received: inputs={'sample_id': 'Tensor(shape=(32, 3))', 'depth_rgb_input': 'Tensor(shape=(32, 12, 12, 3))'}
  warnings.warn(msg)
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'depth_rgb_input': 'depth_rgb_input'}
Received: inputs={'sample_id': 'Tensor(shape=(None, 3))', 'depth_rgb_input': 'Tensor(shape=(None, 12, 12, 3))'}
  warnings.warn(msg)
Epoch 1/2 - loss: 2.0217 - val_loss: 1.8999 - acc: 0.3573 - val_acc: 0.5719 - macro_f1: 0.3514 - val_macro_f1: 0.2672 - kappa: 0.0309 - val_kappa: -0.0218
Epoch 2/2 - loss: 1.8647 - val_loss: 1.7892 - acc: 0.3950 - val_acc: 0.3333 - macro_f1: 0.3923 - val_macro_f1: 0.3159 - kappa: 0.0931 - val_kappa: -0.0157
Restoring model weights from the end of the best epoch: 2.

Run 3 Results for depth_rgb:
              precision    recall  f1-score   support

           I       0.21      0.30      0.24       235
           P       0.55      0.32      0.41       577
           R       0.23      0.43      0.30       148

    accuracy                           0.33       960
   macro avg       0.33      0.35      0.32       960
weighted avg       0.42      0.33      0.35       960

Cohen's Kappa: 0.0602
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized

[3/5] Testing: depth_map

================================================================================
Testing: depth_map
================================================================================
Loading data for depth_map...
Data loaded: 3107 samples
Running 3-fold CV...
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'depth_map_input': 'depth_map_input'}
Received: inputs={'sample_id': 'Tensor(shape=(32, 3))', 'depth_map_input': 'Tensor(shape=(32, 12, 12, 3))'}
  warnings.warn(msg)
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'depth_map_input': 'depth_map_input'}
Received: inputs={'sample_id': 'Tensor(shape=(None, 3))', 'depth_map_input': 'Tensor(shape=(None, 12, 12, 3))'}
  warnings.warn(msg)
Epoch 1/2 - loss: 2.0081 - val_loss: 1.9284 - acc: 0.3548 - val_acc: 0.3094 - macro_f1: 0.3494 - val_macro_f1: 0.2231 - kappa: 0.0317 - val_kappa: 0.0155
Epoch 2/2 - loss: 1.8680 - val_loss: 1.7810 - acc: 0.3653 - val_acc: 0.4865 - macro_f1: 0.3555 - val_macro_f1: 0.3427 - kappa: 0.0474 - val_kappa: 0.0261
Restoring model weights from the end of the best epoch: 2.

Run 1 Results for depth_map:
              precision    recall  f1-score   support

           I       0.28      0.29      0.28       293
           P       0.61      0.67      0.64       716
           R       0.14      0.08      0.11       177

    accuracy                           0.49      1186
   macro avg       0.35      0.35      0.34      1186
weighted avg       0.46      0.49      0.47      1186

Cohen's Kappa: 0.0228
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'depth_map_input': 'depth_map_input'}
Received: inputs={'sample_id': 'Tensor(shape=(32, 3))', 'depth_map_input': 'Tensor(shape=(32, 12, 12, 3))'}
  warnings.warn(msg)
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'depth_map_input': 'depth_map_input'}
Received: inputs={'sample_id': 'Tensor(shape=(None, 3))', 'depth_map_input': 'Tensor(shape=(None, 12, 12, 3))'}
  warnings.warn(msg)
Epoch 1/2 - loss: 2.0047 - val_loss: 1.9252 - acc: 0.3617 - val_acc: 0.2752 - macro_f1: 0.3581 - val_macro_f1: 0.2547 - kappa: 0.0392 - val_kappa: 0.0212
Epoch 2/2 - loss: 1.8497 - val_loss: 1.7819 - acc: 0.3719 - val_acc: 0.2661 - macro_f1: 0.3710 - val_macro_f1: 0.1732 - kappa: 0.0576 - val_kappa: 0.0136
Restoring model weights from the end of the best epoch: 1.

Run 2 Results for depth_map:
              precision    recall  f1-score   support

           I       0.26      0.66      0.38       249
           P       0.69      0.12      0.20       591
           R       0.14      0.26      0.18       152

    accuracy                           0.28       992
   macro avg       0.37      0.34      0.25       992
weighted avg       0.50      0.28      0.24       992

Cohen's Kappa: 0.0027
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'depth_map_input': 'depth_map_input'}
Received: inputs={'sample_id': 'Tensor(shape=(32, 3))', 'depth_map_input': 'Tensor(shape=(32, 12, 12, 3))'}
  warnings.warn(msg)
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'depth_map_input': 'depth_map_input'}
Received: inputs={'sample_id': 'Tensor(shape=(None, 3))', 'depth_map_input': 'Tensor(shape=(None, 12, 12, 3))'}
  warnings.warn(msg)
Epoch 1/2 - loss: 2.0209 - val_loss: 1.9446 - acc: 0.3450 - val_acc: 0.2594 - macro_f1: 0.3251 - val_macro_f1: 0.2578 - kappa: 0.0083 - val_kappa: -0.0103
Epoch 2/2 - loss: 1.8672 - val_loss: 1.8037 - acc: 0.3860 - val_acc: 0.2771 - macro_f1: 0.3618 - val_macro_f1: 0.2415 - kappa: 0.0714 - val_kappa: 0.0022
Restoring model weights from the end of the best epoch: 1.

Run 3 Results for depth_map:
              precision    recall  f1-score   support

           I       0.23      0.35      0.28       235
           P       0.60      0.18      0.27       577
           R       0.15      0.43      0.22       148

    accuracy                           0.26       960
   macro avg       0.33      0.32      0.26       960
weighted avg       0.44      0.26      0.27       960

Cohen's Kappa: -0.0265
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized

[4/5] Testing: thermal_map

================================================================================
Testing: thermal_map
================================================================================
Loading data for thermal_map...
Data loaded: 3107 samples
Running 3-fold CV...
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'thermal_map_input': 'thermal_map_input'}
Received: inputs={'sample_id': 'Tensor(shape=(32, 3))', 'thermal_map_input': 'Tensor(shape=(32, 12, 12, 3))'}
  warnings.warn(msg)
Error during training (attempt 1/3): Unable to automatically build the model. Please build it yourself before calling fit/evaluate/predict. A model is 'built' when its variables have been created and its `self.built` attribute is True. Usually, calling the model on a batch of data is the right way to build it.
Exception encountered:
'Exception encountered when calling Functional.call().

[1mInvalid input shape for input Tensor("Placeholder:0", shape=(32, 3), dtype=float32) with name 'thermal_map_input' and path 'thermal_map_input'. Expected shape (None, 12, 12, 3), but input has incompatible shape (32, 3)[0m

Arguments received by Functional.call():
  â€¢ inputs={'sample_id': 'tf.Tensor(shape=(32, 3), dtype=float32)', 'thermal_map_input': 'tf.Tensor(shape=(32, 12, 12, 3), dtype=float32)'}
  â€¢ training=False
  â€¢ mask={'sample_id': 'None', 'thermal_map_input': 'None'}
  â€¢ kwargs=<class 'inspect._empty'>'
Traceback: Traceback (most recent call last):
  File "/home/rezab/projects/DFUMultiClassification/src/training/training_utils.py", line 1175, in cross_validation_manual_split
    history = model.fit(
              ^^^^^^^^^^
  File "/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/trainers/trainer.py", line 1100, in _symbolic_build
    raise RuntimeError(
RuntimeError: Unable to automatically build the model. Please build it yourself before calling fit/evaluate/predict. A model is 'built' when its variables have been created and its `self.built` attribute is True. Usually, calling the model on a batch of data is the right way to build it.
Exception encountered:
'Exception encountered when calling Functional.call().

[1mInvalid input shape for input Tensor("Placeholder:0", shape=(32, 3), dtype=float32) with name 'thermal_map_input' and path 'thermal_map_input'. Expected shape (None, 12, 12, 3), but input has incompatible shape (32, 3)[0m

Arguments received by Functional.call():
  â€¢ inputs={'sample_id': 'tf.Tensor(shape=(32, 3), dtype=float32)', 'thermal_map_input': 'tf.Tensor(shape=(32, 12, 12, 3), dtype=float32)'}
  â€¢ training=False
  â€¢ mask={'sample_id': 'None', 'thermal_map_input': 'None'}
  â€¢ kwargs=<class 'inspect._empty'>'

/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'thermal_map_input': 'thermal_map_input'}
Received: inputs={'sample_id': 'Tensor(shape=(32, 3))', 'thermal_map_input': 'Tensor(shape=(32, 12, 12, 3))'}
  warnings.warn(msg)
Error during training (attempt 2/3): Unable to automatically build the model. Please build it yourself before calling fit/evaluate/predict. A model is 'built' when its variables have been created and its `self.built` attribute is True. Usually, calling the model on a batch of data is the right way to build it.
Exception encountered:
'Exception encountered when calling Functional.call().

[1mInvalid input shape for input Tensor("Placeholder:0", shape=(32, 3), dtype=float32) with name 'thermal_map_input' and path 'thermal_map_input'. Expected shape (None, 12, 12, 3), but input has incompatible shape (32, 3)[0m

Arguments received by Functional.call():
  â€¢ inputs={'sample_id': 'tf.Tensor(shape=(32, 3), dtype=float32)', 'thermal_map_input': 'tf.Tensor(shape=(32, 12, 12, 3), dtype=float32)'}
  â€¢ training=False
  â€¢ mask={'sample_id': 'None', 'thermal_map_input': 'None'}
  â€¢ kwargs=<class 'inspect._empty'>'
Traceback: Traceback (most recent call last):
  File "/home/rezab/projects/DFUMultiClassification/src/training/training_utils.py", line 1175, in cross_validation_manual_split
    history = model.fit(
              ^^^^^^^^^^
  File "/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/trainers/trainer.py", line 1100, in _symbolic_build
    raise RuntimeError(
RuntimeError: Unable to automatically build the model. Please build it yourself before calling fit/evaluate/predict. A model is 'built' when its variables have been created and its `self.built` attribute is True. Usually, calling the model on a batch of data is the right way to build it.
Exception encountered:
'Exception encountered when calling Functional.call().

[1mInvalid input shape for input Tensor("Placeholder:0", shape=(32, 3), dtype=float32) with name 'thermal_map_input' and path 'thermal_map_input'. Expected shape (None, 12, 12, 3), but input has incompatible shape (32, 3)[0m

Arguments received by Functional.call():
  â€¢ inputs={'sample_id': 'tf.Tensor(shape=(32, 3), dtype=float32)', 'thermal_map_input': 'tf.Tensor(shape=(32, 12, 12, 3), dtype=float32)'}
  â€¢ training=False
  â€¢ mask={'sample_id': 'None', 'thermal_map_input': 'None'}
  â€¢ kwargs=<class 'inspect._empty'>'

/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'thermal_map_input': 'thermal_map_input'}
Received: inputs={'sample_id': 'Tensor(shape=(32, 3))', 'thermal_map_input': 'Tensor(shape=(32, 12, 12, 3))'}
  warnings.warn(msg)
Error during training (attempt 3/3): Unable to automatically build the model. Please build it yourself before calling fit/evaluate/predict. A model is 'built' when its variables have been created and its `self.built` attribute is True. Usually, calling the model on a batch of data is the right way to build it.
Exception encountered:
'Exception encountered when calling Functional.call().

[1mInvalid input shape for input Tensor("Placeholder:0", shape=(32, 3), dtype=float32) with name 'thermal_map_input' and path 'thermal_map_input'. Expected shape (None, 12, 12, 3), but input has incompatible shape (32, 3)[0m

Arguments received by Functional.call():
  â€¢ inputs={'sample_id': 'tf.Tensor(shape=(32, 3), dtype=float32)', 'thermal_map_input': 'tf.Tensor(shape=(32, 12, 12, 3), dtype=float32)'}
  â€¢ training=False
  â€¢ mask={'sample_id': 'None', 'thermal_map_input': 'None'}
  â€¢ kwargs=<class 'inspect._empty'>'
Traceback: Traceback (most recent call last):
  File "/home/rezab/projects/DFUMultiClassification/src/training/training_utils.py", line 1175, in cross_validation_manual_split
    history = model.fit(
              ^^^^^^^^^^
  File "/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/trainers/trainer.py", line 1100, in _symbolic_build
    raise RuntimeError(
RuntimeError: Unable to automatically build the model. Please build it yourself before calling fit/evaluate/predict. A model is 'built' when its variables have been created and its `self.built` attribute is True. Usually, calling the model on a batch of data is the right way to build it.
Exception encountered:
'Exception encountered when calling Functional.call().

[1mInvalid input shape for input Tensor("Placeholder:0", shape=(32, 3), dtype=float32) with name 'thermal_map_input' and path 'thermal_map_input'. Expected shape (None, 12, 12, 3), but input has incompatible shape (32, 3)[0m

Arguments received by Functional.call():
  â€¢ inputs={'sample_id': 'tf.Tensor(shape=(32, 3), dtype=float32)', 'thermal_map_input': 'tf.Tensor(shape=(32, 12, 12, 3), dtype=float32)'}
  â€¢ training=False
  â€¢ mask={'sample_id': 'None', 'thermal_map_input': 'None'}
  â€¢ kwargs=<class 'inspect._empty'>'

ERROR: Training failed for thermal_map after 3 attempts. Skipping this configuration.
Warning: No predictions to save for run 1 (train). Skipping...
Warning: No predictions to save for run 1 (valid). Skipping...
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'thermal_map_input': 'thermal_map_input'}
Received: inputs={'sample_id': 'Tensor(shape=(32, 3))', 'thermal_map_input': 'Tensor(shape=(32, 12, 12, 3))'}
  warnings.warn(msg)
Error during training (attempt 1/3): Unable to automatically build the model. Please build it yourself before calling fit/evaluate/predict. A model is 'built' when its variables have been created and its `self.built` attribute is True. Usually, calling the model on a batch of data is the right way to build it.
Exception encountered:
'Exception encountered when calling Functional.call().

[1mInvalid input shape for input Tensor("Placeholder:0", shape=(32, 3), dtype=float32) with name 'thermal_map_input' and path 'thermal_map_input'. Expected shape (None, 12, 12, 3), but input has incompatible shape (32, 3)[0m

Arguments received by Functional.call():
  â€¢ inputs={'sample_id': 'tf.Tensor(shape=(32, 3), dtype=float32)', 'thermal_map_input': 'tf.Tensor(shape=(32, 12, 12, 3), dtype=float32)'}
  â€¢ training=False
  â€¢ mask={'sample_id': 'None', 'thermal_map_input': 'None'}
  â€¢ kwargs=<class 'inspect._empty'>'
Traceback: Traceback (most recent call last):
  File "/home/rezab/projects/DFUMultiClassification/src/training/training_utils.py", line 1175, in cross_validation_manual_split
    history = model.fit(
              ^^^^^^^^^^
  File "/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/trainers/trainer.py", line 1100, in _symbolic_build
    raise RuntimeError(
RuntimeError: Unable to automatically build the model. Please build it yourself before calling fit/evaluate/predict. A model is 'built' when its variables have been created and its `self.built` attribute is True. Usually, calling the model on a batch of data is the right way to build it.
Exception encountered:
'Exception encountered when calling Functional.call().

[1mInvalid input shape for input Tensor("Placeholder:0", shape=(32, 3), dtype=float32) with name 'thermal_map_input' and path 'thermal_map_input'. Expected shape (None, 12, 12, 3), but input has incompatible shape (32, 3)[0m

Arguments received by Functional.call():
  â€¢ inputs={'sample_id': 'tf.Tensor(shape=(32, 3), dtype=float32)', 'thermal_map_input': 'tf.Tensor(shape=(32, 12, 12, 3), dtype=float32)'}
  â€¢ training=False
  â€¢ mask={'sample_id': 'None', 'thermal_map_input': 'None'}
  â€¢ kwargs=<class 'inspect._empty'>'

/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'thermal_map_input': 'thermal_map_input'}
Received: inputs={'sample_id': 'Tensor(shape=(32, 3))', 'thermal_map_input': 'Tensor(shape=(32, 12, 12, 3))'}
  warnings.warn(msg)
Error during training (attempt 2/3): Unable to automatically build the model. Please build it yourself before calling fit/evaluate/predict. A model is 'built' when its variables have been created and its `self.built` attribute is True. Usually, calling the model on a batch of data is the right way to build it.
Exception encountered:
'Exception encountered when calling Functional.call().

[1mInvalid input shape for input Tensor("Placeholder:0", shape=(32, 3), dtype=float32) with name 'thermal_map_input' and path 'thermal_map_input'. Expected shape (None, 12, 12, 3), but input has incompatible shape (32, 3)[0m

Arguments received by Functional.call():
  â€¢ inputs={'sample_id': 'tf.Tensor(shape=(32, 3), dtype=float32)', 'thermal_map_input': 'tf.Tensor(shape=(32, 12, 12, 3), dtype=float32)'}
  â€¢ training=False
  â€¢ mask={'sample_id': 'None', 'thermal_map_input': 'None'}
  â€¢ kwargs=<class 'inspect._empty'>'
Traceback: Traceback (most recent call last):
  File "/home/rezab/projects/DFUMultiClassification/src/training/training_utils.py", line 1175, in cross_validation_manual_split
    history = model.fit(
              ^^^^^^^^^^
  File "/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/trainers/trainer.py", line 1100, in _symbolic_build
    raise RuntimeError(
RuntimeError: Unable to automatically build the model. Please build it yourself before calling fit/evaluate/predict. A model is 'built' when its variables have been created and its `self.built` attribute is True. Usually, calling the model on a batch of data is the right way to build it.
Exception encountered:
'Exception encountered when calling Functional.call().

[1mInvalid input shape for input Tensor("Placeholder:0", shape=(32, 3), dtype=float32) with name 'thermal_map_input' and path 'thermal_map_input'. Expected shape (None, 12, 12, 3), but input has incompatible shape (32, 3)[0m

Arguments received by Functional.call():
  â€¢ inputs={'sample_id': 'tf.Tensor(shape=(32, 3), dtype=float32)', 'thermal_map_input': 'tf.Tensor(shape=(32, 12, 12, 3), dtype=float32)'}
  â€¢ training=False
  â€¢ mask={'sample_id': 'None', 'thermal_map_input': 'None'}
  â€¢ kwargs=<class 'inspect._empty'>'

/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'thermal_map_input': 'thermal_map_input'}
Received: inputs={'sample_id': 'Tensor(shape=(32, 3))', 'thermal_map_input': 'Tensor(shape=(32, 12, 12, 3))'}
  warnings.warn(msg)
Error during training (attempt 3/3): Unable to automatically build the model. Please build it yourself before calling fit/evaluate/predict. A model is 'built' when its variables have been created and its `self.built` attribute is True. Usually, calling the model on a batch of data is the right way to build it.
Exception encountered:
'Exception encountered when calling Functional.call().

[1mInvalid input shape for input Tensor("Placeholder:0", shape=(32, 3), dtype=float32) with name 'thermal_map_input' and path 'thermal_map_input'. Expected shape (None, 12, 12, 3), but input has incompatible shape (32, 3)[0m

Arguments received by Functional.call():
  â€¢ inputs={'sample_id': 'tf.Tensor(shape=(32, 3), dtype=float32)', 'thermal_map_input': 'tf.Tensor(shape=(32, 12, 12, 3), dtype=float32)'}
  â€¢ training=False
  â€¢ mask={'sample_id': 'None', 'thermal_map_input': 'None'}
  â€¢ kwargs=<class 'inspect._empty'>'
Traceback: Traceback (most recent call last):
  File "/home/rezab/projects/DFUMultiClassification/src/training/training_utils.py", line 1175, in cross_validation_manual_split
    history = model.fit(
              ^^^^^^^^^^
  File "/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/trainers/trainer.py", line 1100, in _symbolic_build
    raise RuntimeError(
RuntimeError: Unable to automatically build the model. Please build it yourself before calling fit/evaluate/predict. A model is 'built' when its variables have been created and its `self.built` attribute is True. Usually, calling the model on a batch of data is the right way to build it.
Exception encountered:
'Exception encountered when calling Functional.call().

[1mInvalid input shape for input Tensor("Placeholder:0", shape=(32, 3), dtype=float32) with name 'thermal_map_input' and path 'thermal_map_input'. Expected shape (None, 12, 12, 3), but input has incompatible shape (32, 3)[0m

Arguments received by Functional.call():
  â€¢ inputs={'sample_id': 'tf.Tensor(shape=(32, 3), dtype=float32)', 'thermal_map_input': 'tf.Tensor(shape=(32, 12, 12, 3), dtype=float32)'}
  â€¢ training=False
  â€¢ mask={'sample_id': 'None', 'thermal_map_input': 'None'}
  â€¢ kwargs=<class 'inspect._empty'>'

ERROR: Training failed for thermal_map after 3 attempts. Skipping this configuration.
Warning: No predictions to save for run 2 (train). Skipping...
Warning: No predictions to save for run 2 (valid). Skipping...
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'thermal_map_input': 'thermal_map_input'}
Received: inputs={'sample_id': 'Tensor(shape=(32, 3))', 'thermal_map_input': 'Tensor(shape=(32, 12, 12, 3))'}
  warnings.warn(msg)
Error during training (attempt 1/3): Unable to automatically build the model. Please build it yourself before calling fit/evaluate/predict. A model is 'built' when its variables have been created and its `self.built` attribute is True. Usually, calling the model on a batch of data is the right way to build it.
Exception encountered:
'Exception encountered when calling Functional.call().

[1mInvalid input shape for input Tensor("Placeholder:0", shape=(32, 3), dtype=float32) with name 'thermal_map_input' and path 'thermal_map_input'. Expected shape (None, 12, 12, 3), but input has incompatible shape (32, 3)[0m

Arguments received by Functional.call():
  â€¢ inputs={'sample_id': 'tf.Tensor(shape=(32, 3), dtype=float32)', 'thermal_map_input': 'tf.Tensor(shape=(32, 12, 12, 3), dtype=float32)'}
  â€¢ training=False
  â€¢ mask={'sample_id': 'None', 'thermal_map_input': 'None'}
  â€¢ kwargs=<class 'inspect._empty'>'
Traceback: Traceback (most recent call last):
  File "/home/rezab/projects/DFUMultiClassification/src/training/training_utils.py", line 1175, in cross_validation_manual_split
    history = model.fit(
              ^^^^^^^^^^
  File "/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/trainers/trainer.py", line 1100, in _symbolic_build
    raise RuntimeError(
RuntimeError: Unable to automatically build the model. Please build it yourself before calling fit/evaluate/predict. A model is 'built' when its variables have been created and its `self.built` attribute is True. Usually, calling the model on a batch of data is the right way to build it.
Exception encountered:
'Exception encountered when calling Functional.call().

[1mInvalid input shape for input Tensor("Placeholder:0", shape=(32, 3), dtype=float32) with name 'thermal_map_input' and path 'thermal_map_input'. Expected shape (None, 12, 12, 3), but input has incompatible shape (32, 3)[0m

Arguments received by Functional.call():
  â€¢ inputs={'sample_id': 'tf.Tensor(shape=(32, 3), dtype=float32)', 'thermal_map_input': 'tf.Tensor(shape=(32, 12, 12, 3), dtype=float32)'}
  â€¢ training=False
  â€¢ mask={'sample_id': 'None', 'thermal_map_input': 'None'}
  â€¢ kwargs=<class 'inspect._empty'>'

/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'thermal_map_input': 'thermal_map_input'}
Received: inputs={'sample_id': 'Tensor(shape=(32, 3))', 'thermal_map_input': 'Tensor(shape=(32, 12, 12, 3))'}
  warnings.warn(msg)
Error during training (attempt 2/3): Unable to automatically build the model. Please build it yourself before calling fit/evaluate/predict. A model is 'built' when its variables have been created and its `self.built` attribute is True. Usually, calling the model on a batch of data is the right way to build it.
Exception encountered:
'Exception encountered when calling Functional.call().

[1mInvalid input shape for input Tensor("Placeholder:0", shape=(32, 3), dtype=float32) with name 'thermal_map_input' and path 'thermal_map_input'. Expected shape (None, 12, 12, 3), but input has incompatible shape (32, 3)[0m

Arguments received by Functional.call():
  â€¢ inputs={'sample_id': 'tf.Tensor(shape=(32, 3), dtype=float32)', 'thermal_map_input': 'tf.Tensor(shape=(32, 12, 12, 3), dtype=float32)'}
  â€¢ training=False
  â€¢ mask={'sample_id': 'None', 'thermal_map_input': 'None'}
  â€¢ kwargs=<class 'inspect._empty'>'
Traceback: Traceback (most recent call last):
  File "/home/rezab/projects/DFUMultiClassification/src/training/training_utils.py", line 1175, in cross_validation_manual_split
    history = model.fit(
              ^^^^^^^^^^
  File "/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/trainers/trainer.py", line 1100, in _symbolic_build
    raise RuntimeError(
RuntimeError: Unable to automatically build the model. Please build it yourself before calling fit/evaluate/predict. A model is 'built' when its variables have been created and its `self.built` attribute is True. Usually, calling the model on a batch of data is the right way to build it.
Exception encountered:
'Exception encountered when calling Functional.call().

[1mInvalid input shape for input Tensor("Placeholder:0", shape=(32, 3), dtype=float32) with name 'thermal_map_input' and path 'thermal_map_input'. Expected shape (None, 12, 12, 3), but input has incompatible shape (32, 3)[0m

Arguments received by Functional.call():
  â€¢ inputs={'sample_id': 'tf.Tensor(shape=(32, 3), dtype=float32)', 'thermal_map_input': 'tf.Tensor(shape=(32, 12, 12, 3), dtype=float32)'}
  â€¢ training=False
  â€¢ mask={'sample_id': 'None', 'thermal_map_input': 'None'}
  â€¢ kwargs=<class 'inspect._empty'>'

/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'thermal_map_input': 'thermal_map_input'}
Received: inputs={'sample_id': 'Tensor(shape=(32, 3))', 'thermal_map_input': 'Tensor(shape=(32, 12, 12, 3))'}
  warnings.warn(msg)
Error during training (attempt 3/3): Unable to automatically build the model. Please build it yourself before calling fit/evaluate/predict. A model is 'built' when its variables have been created and its `self.built` attribute is True. Usually, calling the model on a batch of data is the right way to build it.
Exception encountered:
'Exception encountered when calling Functional.call().

[1mInvalid input shape for input Tensor("Placeholder:0", shape=(32, 3), dtype=float32) with name 'thermal_map_input' and path 'thermal_map_input'. Expected shape (None, 12, 12, 3), but input has incompatible shape (32, 3)[0m

Arguments received by Functional.call():
  â€¢ inputs={'sample_id': 'tf.Tensor(shape=(32, 3), dtype=float32)', 'thermal_map_input': 'tf.Tensor(shape=(32, 12, 12, 3), dtype=float32)'}
  â€¢ training=False
  â€¢ mask={'sample_id': 'None', 'thermal_map_input': 'None'}
  â€¢ kwargs=<class 'inspect._empty'>'
Traceback: Traceback (most recent call last):
  File "/home/rezab/projects/DFUMultiClassification/src/training/training_utils.py", line 1175, in cross_validation_manual_split
    history = model.fit(
              ^^^^^^^^^^
  File "/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/trainers/trainer.py", line 1100, in _symbolic_build
    raise RuntimeError(
RuntimeError: Unable to automatically build the model. Please build it yourself before calling fit/evaluate/predict. A model is 'built' when its variables have been created and its `self.built` attribute is True. Usually, calling the model on a batch of data is the right way to build it.
Exception encountered:
'Exception encountered when calling Functional.call().

[1mInvalid input shape for input Tensor("Placeholder:0", shape=(32, 3), dtype=float32) with name 'thermal_map_input' and path 'thermal_map_input'. Expected shape (None, 12, 12, 3), but input has incompatible shape (32, 3)[0m

Arguments received by Functional.call():
  â€¢ inputs={'sample_id': 'tf.Tensor(shape=(32, 3), dtype=float32)', 'thermal_map_input': 'tf.Tensor(shape=(32, 12, 12, 3), dtype=float32)'}
  â€¢ training=False
  â€¢ mask={'sample_id': 'None', 'thermal_map_input': 'None'}
  â€¢ kwargs=<class 'inspect._empty'>'

ERROR: Training failed for thermal_map after 3 attempts. Skipping this configuration.
Warning: No predictions to save for run 3 (train). Skipping...
Warning: No predictions to save for run 3 (valid). Skipping...

[5/5] Testing: metadata+depth_rgb

================================================================================
Testing: metadata+depth_rgb
================================================================================
Loading data for metadata+depth_rgb...
Data loaded: 3107 samples
Running 3-fold CV...
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'metadata_input': 'metadata_input', 'depth_rgb_input': 'depth_rgb_input'}
Received: inputs={'sample_id': 'Tensor(shape=(32, 3))', 'metadata_input': 'Tensor(shape=(32, 3))', 'depth_rgb_input': 'Tensor(shape=(32, 12, 12, 3))'}
  warnings.warn(msg)
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'metadata_input': 'metadata_input', 'depth_rgb_input': 'depth_rgb_input'}
Received: inputs={'sample_id': 'Tensor(shape=(None, 3))', 'metadata_input': 'Tensor(shape=(None, 3))', 'depth_rgb_input': 'Tensor(shape=(None, 12, 12, 3))'}
  warnings.warn(msg)
Epoch 1/2 - loss: 1.8784 - val_loss: 1.8310 - acc: 0.6631 - val_acc: 0.6113 - macro_f1: 0.6023 - val_macro_f1: 0.2933 - kappa: 0.4942 - val_kappa: 0.0359
Epoch 2/2 - loss: 1.7194 - val_loss: 1.6977 - acc: 0.7423 - val_acc: 0.6113 - macro_f1: 0.7163 - val_macro_f1: 0.2933 - kappa: 0.6133 - val_kappa: 0.0359
Restoring model weights from the end of the best epoch: 1.

Run 1 Results for metadata+depth_rgb:
              precision    recall  f1-score   support

           I       0.00      0.00      0.00       293
           P       0.61      1.00      0.76       716
           R       0.67      0.07      0.12       177

    accuracy                           0.61      1186
   macro avg       0.43      0.35      0.29      1186
weighted avg       0.47      0.61      0.48      1186

Cohen's Kappa: 0.0438
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'metadata_input': 'metadata_input', 'depth_rgb_input': 'depth_rgb_input'}
Received: inputs={'sample_id': 'Tensor(shape=(32, 3))', 'metadata_input': 'Tensor(shape=(32, 3))', 'depth_rgb_input': 'Tensor(shape=(32, 12, 12, 3))'}
  warnings.warn(msg)
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'metadata_input': 'metadata_input', 'depth_rgb_input': 'depth_rgb_input'}
Received: inputs={'sample_id': 'Tensor(shape=(None, 3))', 'metadata_input': 'Tensor(shape=(None, 3))', 'depth_rgb_input': 'Tensor(shape=(None, 12, 12, 3))'}
  warnings.warn(msg)
Epoch 1/2 - loss: 2.2845 - val_loss: 1.9735 - acc: 0.1993 - val_acc: 0.2681 - macro_f1: 0.2638 - val_macro_f1: 0.1696 - kappa: -0.2126 - val_kappa: 0.0039
Epoch 2/2 - loss: 2.1054 - val_loss: 1.8293 - acc: 0.2490 - val_acc: 0.2873 - macro_f1: 0.2959 - val_macro_f1: 0.1924 - kappa: -0.1306 - val_kappa: 0.0160
Restoring model weights from the end of the best epoch: 2.

Run 2 Results for metadata+depth_rgb:
              precision    recall  f1-score   support

           I       0.26      0.96      0.41       249
           P       0.58      0.07      0.13       591
           R       1.00      0.02      0.04       152

    accuracy                           0.29       992
   macro avg       0.62      0.35      0.19       992
weighted avg       0.57      0.29      0.18       992

Cohen's Kappa: 0.0449
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._check_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._check_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'metadata_input': 'metadata_input', 'depth_rgb_input': 'depth_rgb_input'}
Received: inputs={'sample_id': 'Tensor(shape=(32, 3))', 'metadata_input': 'Tensor(shape=(32, 3))', 'depth_rgb_input': 'Tensor(shape=(32, 12, 12, 3))'}
  warnings.warn(msg)
/home/rezab/projects/enviroments/multimodal/lib/python3.12/site-packages/keras/src/models/functional.py:241: UserWarning: The structure of `inputs` doesn't match the expected structure.
Expected: {'metadata_input': 'metadata_input', 'depth_rgb_input': 'depth_rgb_input'}
Received: inputs={'sample_id': 'Tensor(shape=(None, 3))', 'metadata_input': 'Tensor(shape=(None, 3))', 'depth_rgb_input': 'Tensor(shape=(None, 12, 12, 3))'}
  warnings.warn(msg)
Epoch 1/2 - loss: 2.0149 - val_loss: 2.0013 - acc: 0.4165 - val_acc: 0.1896 - macro_f1: 0.4183 - val_macro_f1: 0.1867 - kappa: 0.1347 - val_kappa: 0.0167
Epoch 2/2 - loss: 1.8307 - val_loss: 1.8439 - acc: 0.5008 - val_acc: 0.2156 - macro_f1: 0.4707 - val_macro_f1: 0.2135 - kappa: 0.2631 - val_kappa: 0.0386
Restoring model weights from the end of the best epoch: 2.

Run 3 Results for metadata+depth_rgb:
              precision    recall  f1-score   support

           I       0.32      0.37      0.35       235
           P       0.67      0.01      0.02       577
           R       0.17      0.76      0.27       148

    accuracy                           0.22       960
   macro avg       0.39      0.38      0.21       960
weighted avg       0.51      0.22      0.14       960

Cohen's Kappa: 0.0834
clear_gpu_memory Warning: Physical devices cannot be modified after being initialized

================================================================================
Test complete! Results saved to: agent_communication/results_comprehensive_cv_test.txt
================================================================================
JSON results saved to: agent_communication/results_comprehensive_cv_test.json
Terminal log saved to: agent_communication/terminal_output_comprehensive_cv.txt
