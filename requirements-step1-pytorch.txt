# ==============================================================================
# STEP 1: PyTorch with CUDA 12 binaries
# ==============================================================================
# Run: pip install -r requirements-step1-pytorch.txt
#
# WHY A SEPARATE FILE?
# --------------------
# PyTorch on PyPI defaults to CUDA 11.8 binaries, which are INCOMPATIBLE with
# RTX 4090/5090 (require CUDA 12). We must use PyTorch's cu121 index.
#
# The --index-url directive MUST be at the top of a requirements file or passed
# via command line. It cannot be embedded in conda's pip section.
#
# WHAT THIS INSTALLS:
# -------------------
# - torch: Core PyTorch with CUDA 12.1 support
# - torchvision: Computer vision utilities (matches torch CUDA version)
#
# NOTE ON cuDNN:
# --------------
# PyTorch cu121 installs nvidia-cudnn-cu12==9.x, but TensorFlow 2.15.1 needs
# nvidia-cudnn-cu12==8.9.4.25. Step 2 will fix this by force-reinstalling
# the correct cuDNN version. Do NOT worry about the cuDNN version after this step.
#
# VERIFICATION:
# -------------
# python -c "import torch; print('PyTorch:', torch.__version__); print('CUDA:', torch.cuda.is_available())"
# Expected: PyTorch: 2.x.x+cu121, CUDA: True
#
# ==============================================================================

--index-url https://download.pytorch.org/whl/cu121

torch
torchvision
